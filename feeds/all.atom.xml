<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Ian Hawke</title><link href="http://IanHawke.github.io/blog/" rel="alternate"></link><link href="http://IanHawke.github.io/blog/feeds/all.atom.xml" rel="self"></link><id>http://IanHawke.github.io/blog/</id><updated>2016-10-04T16:00:00+01:00</updated><entry><title>Resistive Plasmas</title><link href="http://IanHawke.github.io/blog/resistive-plasmas.html" rel="alternate"></link><updated>2016-10-04T16:00:00+01:00</updated><author><name>'Ian Hawke'</name></author><id>tag:IanHawke.github.io,2016-10-04:blog/resistive-plasmas.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;All models are wrong, but some are useful.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We're interested in numerical simulations of neutron stars, for predicting observable signals (for example from gravitational waves, or in X-ray) from the inspiral and merger. This &lt;a href="https://en.wikipedia.org/wiki/All_models_are_wrong"&gt;quote from George Box&lt;/a&gt; is the core of the steps we take. It's impossible to model fundamental particle interactions when your grid cells are tens to hundreds of metres across, so we approximate. The question we tackle in &lt;a href="https://arxiv.org/abs/1610.00445"&gt;these&lt;/a&gt; &lt;a href="https://arxiv.org/abs/1610.00448"&gt;three&lt;/a&gt; &lt;a href="https://arxiv.org/abs/1610.00449"&gt;papers&lt;/a&gt; is how much our choice of approximation matters, and how we can make it better.&lt;/p&gt;
&lt;p&gt;The standard approximation is ideal (magneto)hydrodynamics: the Living Reviews of &lt;a href="http://dx.doi.org/10.1007/lrca-2015-3"&gt;Martí and Müller&lt;/a&gt; or &lt;a href="http://www.livingreviews.org/lrr-2008-7"&gt;Font&lt;/a&gt; show just how far this approximation can take us. Here all the particles move together, without viscosity or resistance, and the magnetic field is locked to the fluid. As we need some relative flow between the charged particles to generate the magnetic field in the first place, it's clear that some substantial simplification has gone on here: what's not clear is how much it matters.&lt;/p&gt;
&lt;p&gt;There's two ways to build a more "realistic" model: add in the extra physics by hand, or build a complex but consistent model from first principles. As relativity has some really nice features, such as energy conservation and causality, that we don't want to lose, we took the second route.&lt;/p&gt;
&lt;p&gt;We started from a variational approach to relativistic fluids. While they've been around a long time, variational approaches that include multiple fluids are newer, and building a model that &lt;a href="http://dx.doi.org/10.1088/0264-9381/32/7/075008"&gt;includes resistance and dissipation directly from the variation&lt;/a&gt; is very recent. By including charge we can build a model that includes multiple interacting fluids that interact via scattering, with particle creation and resistance between their relative flows.&lt;/p&gt;
&lt;p&gt;There are three papers describing the work so far. In &lt;a href="https://arxiv.org/abs/1610.00445"&gt;the first&lt;/a&gt; we develop the formalism, adding charges into the action and derive the equations of motion. In principle this tells us how to compute, &lt;em&gt;ab initio&lt;/em&gt;, the resistance between the flows and the particle creation rates. In reality this isn't possible: what we could imagine measuring isn't the information we need. Instead, we use these results to derive the essential constraints that &lt;em&gt;must&lt;/em&gt; apply to consistent phenomenological models.&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://arxiv.org/abs/1610.00448"&gt;second paper&lt;/a&gt; goes deeper into building phenomenological models. Using a "1+3" or fibration approach (as in cosmology, for example) it builds a sequence of ever more complex approximate models, with the aim of seeing how far we need to go to model a hot, magnetized neutron star. By the end we have models with heat flow and resistivity, including a consistent derivation of the thermo-electric effect, all in nonlinear GR.&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://arxiv.org/abs/1610.00449"&gt;third paper&lt;/a&gt; takes the orthogonal approach, and builds a "3+1" or foliation model as used in nearly all numerical relativity simulations. By concentrating on slightly simpler models we derive consistent balance laws for hot resistive plasmas including resistivity, as needed for nonlinear simulations of neutron star mergers. However, there's still substantial work needed here, as we show that there are significant technical issues with including the entrainment effect, which is one of the most interesting things to study in numerical evolutions.&lt;/p&gt;
&lt;p&gt;Work on these three papers has occupied a lot of time for Nils Andersson, Greg Comer, Kyriaki Dionysopoulou, and myself, over the past few years. It's a significant step forward in the frameworks needed for numerical relativity. However, there's a lot more work to do, particularly in actually getting numerical simulations from these equations. Kiki in particular has made great steps in this direction, and the first results should be public soon.&lt;/p&gt;</summary><category term="Papers"></category></entry><entry><title>How to write an academic paper in under an hour</title><link href="http://IanHawke.github.io/blog/how-to-write-an-academic-paper-in-under-an-hour.html" rel="alternate"></link><updated>2016-06-02T12:00:00+01:00</updated><author><name>'Alice Harpole'</name></author><id>tag:IanHawke.github.io,2016-06-02:blog/how-to-write-an-academic-paper-in-under-an-hour.html</id><summary type="html">&lt;p&gt;New journals appear all the time, and few are worth paying attention to. When the &lt;a href="http://joss.theoj.org/"&gt;Journal of Open Source Software&lt;/a&gt; (&lt;a href="https://twitter.com/JOSS_TheOJ"&gt;JOSS&lt;/a&gt;) launched in early May, a few things made it stand out.&lt;/p&gt;
&lt;p&gt;First, it's specifically for scientific &lt;em&gt;code&lt;/em&gt;, an area that's been problematic for many journals for a long time. Second, it's an &lt;a href="http://www.nature.com/news/open-journals-that-piggyback-on-arxiv-gather-momentum-1.19102"&gt;overlay journal&lt;/a&gt;, in this case piggybacking on &lt;a href="https://github.com/"&gt;GitHub&lt;/a&gt;, which is a (fairly) new and interesting development for open scientific publishing. And finally, it &lt;a href="http://joss.theoj.org/about#author_guidelines"&gt;suggests that&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;...we expect that it should take less than an hour to prepare and submit your paper to JOSS.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There's a challenge to be tried.&lt;/p&gt;
&lt;h2&gt;The paper&lt;/h2&gt;
&lt;p&gt;So, less than a week after the journal launched, we (Alice Harpole and Ian Hawke) decided to give it a try. Now that &lt;a href="http://joss.theoj.org/papers/10.21105/joss.00016"&gt;our paper&lt;/a&gt; has &lt;a href="https://github.com/openjournals/joss-reviews/issues/16"&gt;been accepted&lt;/a&gt; we can confirm that the total time writing the paper was under an hour: roughly half an hour for the original paper, and twenty minutes for the revision.&lt;/p&gt;
&lt;p&gt;What's the trick? Well, it's like running a marathon in under three hours: once you've run the first 26 miles in under two, doing the final 385 yards in under an hour isn't a problem.&lt;/p&gt;
&lt;p&gt;The point here, that JOSS makes explicit, is that a "code paper" is, in large part, advertising the existence, documentation, and tests of the code. These are &lt;em&gt;essential&lt;/em&gt; things that shouldn't need an academic journal paper: they should be part of good scientific practice. Running the first 26 miles is getting the code and all the essential best practice parts in place: the final 385 yards is a brief paper advertising the steps you took.&lt;/p&gt;
&lt;h2&gt;The steps in brief&lt;/h2&gt;
&lt;p&gt;So, what are the steps that we took that made writing the paper so simple?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Have an idea for a scientific code.&lt;/li&gt;
&lt;li&gt;Make the code publicly available.&lt;/li&gt;
&lt;li&gt;Give the code an open license.&lt;/li&gt;
&lt;li&gt;Write tests for the code, using continuous integration, that covers all key parts.&lt;/li&gt;
&lt;li&gt;Document the code, with plenty of examples, publicly hosted, being clear about what the code can do, and how fast.&lt;/li&gt;
&lt;li&gt;Make sure the code is easy to install.&lt;/li&gt;
&lt;li&gt;Release the code through an archiving service.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;The steps at length&lt;/h2&gt;
&lt;h3&gt;The idea&lt;/h3&gt;
&lt;p&gt;This is sometimes the hard part, as most scientists can't get their ideas from the &lt;a href="https://books.google.co.uk/books?id=dYvIAAAAQBAJ&amp;amp;pg=PT162&amp;amp;lpg=PT162&amp;amp;dq=get+ideas+from+old+lady+schenectady+harlan+ellison&amp;amp;source=bl&amp;amp;ots=SqtFK2b2FB&amp;amp;sig=6lkC1JaCNRDe6NAFyZp2AYkbXY4&amp;amp;hl=en&amp;amp;sa=X&amp;amp;ved=0ahUKEwiviurV54fNAhXII8AKHfplASIQ6AEIJTAB#v=onepage&amp;amp;q=get%20ideas%20from%20old%20lady%20schenectady%20harlan%20ellison&amp;amp;f=false"&gt;little old lady from Schenectady&lt;/a&gt;. In our case, we needed a test case for a different project we were working on. The code rapidly spiralled from a short script to something rather more complex, and became a test case for much of what follows.&lt;/p&gt;
&lt;h3&gt;Making it public&lt;/h3&gt;
&lt;p&gt;Cloud based version control repositories are the easiest way to do this for now. We used &lt;a href="https://github.com/"&gt;GitHub&lt;/a&gt; pretty much &lt;a href="https://github.com/harpolea/r3d2/commit/c13c3ebbe18a2c12a0d856b0425bfe4890c093df"&gt;from the start&lt;/a&gt;; with GitHub now offering private repositories to academics, it's straightforward to start private and shift public for release.&lt;/p&gt;
&lt;h3&gt;Give the code an open license&lt;/h3&gt;
&lt;p&gt;When you create a new repository GitHub &lt;a href="https://help.github.com/articles/open-source-licensing/"&gt;asks what license you want to give it&lt;/a&gt;. In our case we initially forgot (bad mistake), but updated to the &lt;a href="http://choosealicense.com/licenses/mit/"&gt;MIT license&lt;/a&gt; shortly after submission. Note that &lt;a href="http://joss.theoj.org/about#content_license"&gt;JOSS does specify&lt;/a&gt; the license of the papers, but you must specify the license for your code in advance.&lt;/p&gt;
&lt;h3&gt;Write tests&lt;/h3&gt;
&lt;p&gt;We were working with Python for &lt;a href="https://github.com/harpolea/r3d2"&gt;our code&lt;/a&gt;, so could use a standard, and simple, unit testing framework. We chose &lt;a href="http://nose.readthedocs.io/en/latest/"&gt;nose&lt;/a&gt; (as one of us had used it before). This ensured that the results matched existing codes in certain simple cases that could be directly compared, and could be used for regression tests in more complex cases.&lt;/p&gt;
&lt;p&gt;With a modern testing framework like this, it's very useful to tie the testing into the GitHub version control using &lt;em&gt;continuous integration&lt;/em&gt;. For this we used &lt;a href="https://travis-ci.org/harpolea/r3d2"&gt;Travis&lt;/a&gt; which directly integrates with GitHub. This has the large advantage of rapidly testing the code on many versions of Python, for every commit or pull request. It had the downside of needing some fiddling to make work, as seen by the &lt;a href="https://github.com/harpolea/r3d2/blob/master/.travis.yml"&gt;history of the &lt;code&gt;.travis.yml&lt;/code&gt; file&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To check &lt;em&gt;how much&lt;/em&gt; of the code we were actually testing, we could link GitHub and Travis to a code coverage checker - here it was &lt;a href="https://codecov.io/github/harpolea/r3d2?branch=master"&gt;codecov.io&lt;/a&gt;. Here the key was to work out what we &lt;em&gt;shouldn't&lt;/em&gt; worry about testing - in our case, the plotting code was inessential - to focus on getting the science code right. The exclusions are managed through the &lt;a href="https://github.com/harpolea/r3d2/blob/master/.coveragerc"&gt;&lt;code&gt;.coveragerc&lt;/code&gt; file&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Document the code&lt;/h3&gt;
&lt;h4&gt;README&lt;/h4&gt;
&lt;p&gt;The top level &lt;a href="https://github.com/harpolea/r3d2/blob/master/README.rst"&gt;README&lt;/a&gt; needs to cover a lot of ground. Most important are what the code is meant to do, how to get and install it, how to use it, and how to get support. Installation will come later. In our case, support and contributions is all dealt with by &lt;a href="https://guides.github.com/features/issues/"&gt;GitHub issues&lt;/a&gt;. The purpose of the code should be the focus, particularly as this brief, punchy introduction should closely mirror the content of the paper for JOSS!&lt;/p&gt;
&lt;h4&gt;Examples&lt;/h4&gt;
&lt;p&gt;When writing the code we were (and still are) planning on using it to produce tests for another project and paper. This required a broad range of examples, most of which were best illustrated by examples using the code directly. As it's a Python code it had been specifically designed to work within &lt;a href="http://jupyter.org/"&gt;Jupyter notebooks&lt;/a&gt;, so that modifications to examples could be rapidly displayed. The documentation was originally written directly into Jupyter notebooks with the intention of &lt;em&gt;directly converting&lt;/em&gt; the text and figures into a later paper.&lt;/p&gt;
&lt;p&gt;This had a specific advantage when producing documentation for the code: Jupyter notebooks are now so popular that there's many tools that directly convert them into useful online forms. The first, central tool is &lt;a href="http://www.sphinx-doc.org/en/stable/"&gt;&lt;code&gt;sphinx&lt;/code&gt;&lt;/a&gt;, which is used to generate documentation for many projects, particularly those based on Python. Once sphinx was setup, we could then use &lt;a href="http://nbsphinx.readthedocs.io/en/0.2.8/"&gt;&lt;code&gt;nbsphinx&lt;/code&gt;&lt;/a&gt;, which directly converts Jupyter notebooks to sphinx documentation. This means creating documentation with up-to-date examples is simple: write the code and accompanying text into a Jupyter notebook, and &lt;code&gt;nbsphinx&lt;/code&gt; will run it automatically to produce the documentation.&lt;/p&gt;
&lt;p&gt;To clearly host the documentation online there is another key integration with GitHub: &lt;a href="http://readthedocs.org/"&gt;Read the Docs&lt;/a&gt;. If you have &lt;code&gt;sphinx&lt;/code&gt; documentation in a GitHub project then Read the Docs will host it, giving automatically generated, clean &lt;a href="http://r3d2.readthedocs.io/en/latest/?badge=latest"&gt;HTML documentation&lt;/a&gt;, with the option to generate &lt;a href="https://media.readthedocs.org/pdf/r3d2/latest/r3d2.pdf"&gt;PDF&lt;/a&gt; and &lt;a href="http://readthedocs.org/projects/r3d2/downloads/epub/latest/"&gt;epub&lt;/a&gt; documents if required. Just to note: the documentation on Read the Docs was something the reviewer &lt;a href="https://github.com/openjournals/joss-reviews/issues/16#issuecomment-221051899"&gt;particularly liked&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;However, there are a few pain points that should be noted here. A minor one is the inclusion of mathematics in the documentation: to make this show up cleanly in the epub version requires using the &lt;code&gt;mathpng&lt;/code&gt; extension, (see eg &lt;a href="https://github.com/IanHawke/maths-with-python/commit/2c67152263d47ad63409a2ba919488a3b55fa060"&gt;this commit&lt;/a&gt; for &lt;a href="http://maths-with-python.readthedocs.io/en/latest/"&gt;this set of documentation&lt;/a&gt;) which doesn't display as nicely online. A more important issue is that getting the documentation to build on Read the Docs can be very painful: we still do not have a robust, reliable build process, as it often "randomly" fails.&lt;/p&gt;
&lt;h4&gt;Code API&lt;/h4&gt;
&lt;p&gt;Finally, remember to document the internals of the code. This was another place we slipped up initially, but is particularly important when people want to contribute and extend your code. Sticking to a convention is useful, as it usually means that IDEs can find and nicely format your internal documentation. We chose &lt;a href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt"&gt;&lt;code&gt;numpydoc&lt;/code&gt;&lt;/a&gt;, following &lt;a href="http://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_numpy.html"&gt;standard examples&lt;/a&gt;, as we've used it in the past.&lt;/p&gt;
&lt;h3&gt;Installation&lt;/h3&gt;
&lt;p&gt;There is nothing as frustrating as finding a code that may solve your problem, but having to spend hours or days trying to install it just to test it out. For plain Python code it's usually fairly simple to test something out, but it can be made nearly seamless by using &lt;a href="https://pypi.python.org/pypi"&gt;PyPI&lt;/a&gt;. There are &lt;a href="https://docs.python.org/3.1/distutils/uploading.html"&gt;many&lt;/a&gt; &lt;a href="http://peterdowns.com/posts/first-time-with-pypi.html"&gt;example&lt;/a&gt; &lt;a href="https://hynek.me/articles/sharing-your-labor-of-love-pypi-quick-and-dirty/"&gt;tutorials&lt;/a&gt; of how to upload your package to PyPI, and it's definitely worth the time to experiment with this to ease the installation pain for your users, and for yourself.&lt;/p&gt;
&lt;p&gt;Once you've decided on an installation route, make sure to document this clearly in the top level README and the start of the documentation. It's important to get the dependencies in there!&lt;/p&gt;
&lt;h3&gt;Release the code&lt;/h3&gt;
&lt;p&gt;Code changes to fix bugs and to keep track of changes in its dependencies. However, a scientific code must be reproducible, so the original version associated with the paper must be stored. With GitHub this can be done via an integration with &lt;a href="https://zenodo.org/"&gt;Zenodo&lt;/a&gt;, by creating a &lt;a href="https://help.github.com/articles/creating-releases/"&gt;&lt;em&gt;release&lt;/em&gt;&lt;/a&gt;. In addition to giving you a fixed, archived version of the code, it also gives you a &lt;a href="https://zenodo.org/badge/latestdoi/21891/harpolea/r3d2"&gt;DOI&lt;/a&gt; to refer to it by.&lt;/p&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;There's a lot going on in scientific publishing right now, and a lot of questions about how papers and journals of the future should look. An important question is whether the requirements and incentives of producing papers for "standard" journals are aligned for modern scientific best practices. This is an area where &lt;a href="http://joss.theoj.org/"&gt;JOSS&lt;/a&gt; stands out: it has explicitly set out to reward good scientific coding practice with the key incentive - a publication. It will be interesting to see how this will evolve, and if journals in other areas can follow suit.&lt;/p&gt;</summary><category term="Papers"></category></entry><entry><title>How do you choose a reproducibility metric?</title><link href="http://IanHawke.github.io/blog/how-do-you-choose-a-reproducibility-metric.html" rel="alternate"></link><updated>2016-05-19T12:00:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2016-05-19:blog/how-do-you-choose-a-reproducibility-metric.html</id><summary type="html">&lt;p&gt;Some papers are effortlessly brilliant. Some show their brilliance by lifting the lid on just how much work it is to do it &lt;em&gt;right&lt;/em&gt;. Olivier Mesnard and Lorena Barba just &lt;a href="http://arxiv.org/abs/1605.04339"&gt;released a preprint&lt;/a&gt; whose title, "&lt;em&gt;Reproducible and replicable CFD: it's harder than you think&lt;/em&gt;", shows it firmly belongs in the latter camp. Combine that with the &lt;a href="https://github.com/barbagroup/snake-repro"&gt;detailed repository&lt;/a&gt; containing all the code needed to do the work, there's enough information to lose a couple of days.&lt;/p&gt;
&lt;p&gt;What most interests me is the criteria chosen for successful reproducibility. I've argued before about what is &lt;a href="http://ianhawke.github.io/blog/close-enough.html"&gt;close enough&lt;/a&gt; when comparing a numerical simulation to theoretical expectations, and about &lt;a href="http://ianhawke.github.io/blog/the-image-is-the-simulation.html"&gt;the minimum I'd like to be able to reproduce&lt;/a&gt;. But Mesnard and Barba's paper is far more complex, and is code versus code comparison with experimental backup, not code versus theory. The criteria discussed in the introduction include&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A previous experimental study had already shown that the lift coefficient of a snake cross section in a wind tunnel gets an extra oomph of lift at 35 degrees angle-of-attack. Our simulations showed the same feature in the plot of lift coefficient. Many detailed observations of the wake (visualized from the fluid-flow solution in terms of the vorticity field in space and time) allowed us to give an explanation of the mechanism providing extra lift.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is a much more complex than comparing a single number. Hence the paper contains statements such as&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Is it acceptable as a replication study? We think yes, but this is a judgement call.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;we make a judgement call that this result does indeed pass muster as a replication of our previous study.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;How is this judgement call made? Is this art or science? What needs to be reproduced, and how closely?&lt;/p&gt;
&lt;h2&gt;Samurai and Ninja&lt;/h2&gt;
&lt;p&gt;To think further about this, let's look at a totally different study: the detection of gravitational waves from binary black holes. Long before the &lt;a href="http://www.ligo.org/science/Publication-GW150914/index.php"&gt;GW150914 observation&lt;/a&gt; there was a lot of concern about the accuracy of numerical simulations of black holes. After a lot of effort, gravitational wave signals were finally being computed from numerical simulations. With no experiment to compare against, and with significant differences in both the form of the equations and the numerical methods used, the possibility that some, if not all, of the simulations were simply wrong was a big worry.&lt;/p&gt;
&lt;p&gt;The &lt;a href="http://journals.aps.org/prd/abstract/10.1103/PhysRevD.79.084025"&gt;Samurai&lt;/a&gt; (&lt;a href="http://arxiv.org/abs/0901.2437"&gt;arXiv link&lt;/a&gt;) and &lt;a href="http://iopscience.iop.org/article/10.1088/0264-9381/26/16/165008/meta"&gt;Ninja&lt;/a&gt; (&lt;a href="http://arxiv.org/abs/0901.4399"&gt;arXiv link&lt;/a&gt;) papers were the result. In both cases the key question was "Does it make any difference to a &lt;em&gt;detection&lt;/em&gt; if we use one numerical result rather than another?". There was a clear metric, given by the "best mismatch" between predicted waveforms, after folding in the expected noise from the experiment. In the Ninja paper waveforms predicted by different codes were directly compared; in the Samurai paper the link to the full data analysis pipelines are made, to see what useful information can be pulled out.&lt;/p&gt;
&lt;p&gt;The result was simple: for current detectors, &lt;em&gt;all&lt;/em&gt; the numerical results were effectively indistinguishable. The difficulty of doing the experiment at all constrained the results so that only the grossest, most qualitative features of the simulations stood out from the noise. This reproducibility metric worked, but hid many of the interesting differences between the simulations. However, without any experiment that could show the differences, is there a point in going further?&lt;/p&gt;
&lt;h2&gt;Questioning the metric&lt;/h2&gt;
&lt;p&gt;In the Mesnard and Barba case, they have broadly specified two "metrics":&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;the variation of the lift coefficient with angle-of-attack;&lt;/li&gt;
&lt;li&gt;features in the wake explaining the lift mechanism.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The simplest numerical metric is the variation of the lift coefficient, and figures 3, 6, and 8 of their paper show how the time averaged lift coefficients compare across simulations and experiment. What is more interesting to me is the way that Mesnard and Barba challenge this metric, by looking at the variation of the instantaneous lift coefficients (figures 4, 7, 9, and 11), discussing the impact of some of the arbitrary choices (such as the time period over which the averaging is done), and the simulation issues that could cause this. This links to the second metric: by exploring the wake features they can explain issues with the simulations, including meshing and boundary condition problems. These are clear from some of the figures, but difficult to quantify.&lt;/p&gt;
&lt;p&gt;This shows a clear difference from the Samurai and Ninja papers. The first metric is there to reproduce the experimental result. If the theory is certain and the mechanism clear, there's nothing more to say. But for the Mesnard and Barba reproduction, they wish in addition to test the &lt;em&gt;explanation&lt;/em&gt; of the results. This means digging deeper into the details of the simulation results, which in turn shows differences in the lift coefficients. Their reproduction is going beyond the numerical matching of an experimental result and into the physical prediction that a detailed numerical simulation can give.&lt;/p&gt;
&lt;h2&gt;Lessons&lt;/h2&gt;
&lt;p&gt;Mesnard and Barba detail their lessons learned, but to me this paper brings home yet another point. Reproducibility has a number of technical aspects which can be extremely hard, as beautifully illustrated by this paper. However, it also has the human, non-technical aspect of choosing &lt;em&gt;what&lt;/em&gt; needs to be reproduced: what is the metric? Finally, there's the issue of how that metric will change over time, as the depth of the reproduction goes from the general features that an experiment will catch to the qualitative details that "explain" why something happens.&lt;/p&gt;</summary><category term="Reproducibility"></category></entry><entry><title>Thank you letters to the EU</title><link href="http://IanHawke.github.io/blog/thank-you-letters-to-the-eu.html" rel="alternate"></link><updated>2016-01-01T09:00:00+00:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2016-01-01:blog/thank-you-letters-to-the-eu.html</id><summary type="html">&lt;p&gt;As a tiny kid I'd start those post-Christmas thank-you letters with the simplest home address:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;7 Greyfriars Road&lt;/p&gt;
&lt;p&gt;Fareham&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As an older kid, I found it fascinating to add every possible layer to this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;7 Greyfriars Road&lt;/p&gt;
&lt;p&gt;Titchfield&lt;/p&gt;
&lt;p&gt;Nr Catisfield&lt;/p&gt;
&lt;p&gt;Fareham&lt;/p&gt;
&lt;p&gt;Hampshire&lt;/p&gt;
&lt;p&gt;England&lt;/p&gt;
&lt;p&gt;UK&lt;/p&gt;
&lt;p&gt;Europe&lt;/p&gt;
&lt;p&gt;Earth&lt;/p&gt;
&lt;p&gt;Solar System&lt;/p&gt;
&lt;p&gt;Milky Way...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It was a first contact with &lt;em&gt;orders of magnitude&lt;/em&gt;, as in &lt;a href="https://www.youtube.com/watch?v=0fKBhvDjuy0"&gt;Powers of 10&lt;/a&gt;: first, the family in my house, then the neighbours on my road, then the people in my village, town, county, country, and so on up. The transition to obsessing about space, mathematics, and science, linking to ever larger structures and ideas, seemed a big part of that.&lt;/p&gt;
&lt;p&gt;There's a key word in that sequence whose meaning has changed, for me, over the course of my life:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Europe&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;From just being a name for the continent on which I lived, to being an ever-changing and adapting community - half a billion people dreaming and working and squabbling to improve their lives. I only managed to live outside the UK for three years - a postdoc in Germany - but the way it broadened my thinking and brought me into contact with so many great people had to make it the best experience of my professional life.&lt;/p&gt;
&lt;p&gt;Some time this year there is likely to be a referendum on Britain in Europe. I'm instinctively pro-Europe, and will definitely vote to stay in. To me, none of the arguments for leaving make sense, and the economic and &lt;a href="http://scientistsforeu.uk/"&gt;scientific&lt;/a&gt; arguments for staying in are obvious. But these arguments aren't enough, or even the main reason why I'll vote to stay in.&lt;/p&gt;
&lt;p&gt;Europe is a fuzzy dream that being built and argued over by a huge number of people. By being in - by engaging, and arguing, and pushing the agendas we want - we are helping and participating in that building process. A new, complex, imperfect but amazing community is coming alive. The more we get involved the broader our dreams will be, the better we'll define our place in the world, and the wider and bigger the impact of our actions will be. We won't get our way, or all of our dream, but why should we expect to in a community of half a billion? But we'll get some of what we want, and it will make us more open, more engaged, and just better people for taking part.&lt;/p&gt;
&lt;p&gt;Many current "out" arguments say we could do everything out as well as in, but with more freedom and money. It's hard to argue with "&lt;em&gt;could&lt;/em&gt;". However, I think that if we vote to leave, we'll fold inwards. A parochial, boring, irrelevant Britain would be the result. Any individual could make that leap, get those connections, and make their horizons bigger, broader and better. But as a country we'd be saying we just didn't care.&lt;/p&gt;</summary><category term="Politics"></category></entry><entry><title>The image is the simulation</title><link href="http://IanHawke.github.io/blog/the-image-is-the-simulation.html" rel="alternate"></link><updated>2015-06-01T09:00:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-06-01:blog/the-image-is-the-simulation.html</id><summary type="html">&lt;p&gt;Reproducibility in science is of obvious importance, and the number of retractions and papers tackling this have highlighted the distance we still have to go. There's also been a lot of work on producing tools that make reproducibility easier, and a push to embed this through training. At the very least, the goals of the Recomputation Manifesto look to be closer now.&lt;/p&gt;
&lt;p&gt;My thought here is about &lt;em&gt;what&lt;/em&gt; is reproduced, not &lt;em&gt;how&lt;/em&gt;. In particular, what is it that represents a computer simulation?&lt;/p&gt;
&lt;h2&gt;Papers versus images&lt;/h2&gt;
&lt;p&gt;To most academics, the currency is papers and grants. As no funding agency has yet required a reproducible grant proposal, a lot of focus has gone into reproducible papers. At the same time, there's been a lot of comment that "the academic paper is dead or dying", or at least won't be fit for purpose in the near future. There's a minor conflict here, which may be one reason why reproducible &lt;em&gt;papers&lt;/em&gt; have gained less traction than reproducible &lt;em&gt;code&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Leaving that aside, to me the paper doesn't &lt;em&gt;represent&lt;/em&gt; the simulation. &lt;em&gt;My&lt;/em&gt; simulations build on detailed thought, carefully constructed code, and the best analysis I can produce of the complex resulting data. With the same level of seriousness, &lt;em&gt;your&lt;/em&gt; simulations are impressive work, but with weird voodoo magic I don't understand, and &lt;em&gt;their&lt;/em&gt; simulations are just a fancy visualization package on top of a random number generator.&lt;/p&gt;
&lt;p&gt;The serious point: to me, a simulation is&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the problem being studied;&lt;/li&gt;
&lt;li&gt;the questions we're trying to answer;&lt;/li&gt;
&lt;li&gt;how widely applicable, and accurate, we think our answers are.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Most of the detail that covers these points is summed up not in the paper, but in the figures and figure captions. The paper is "just" the framework and prose glue that holds the figures together.&lt;/p&gt;
&lt;p&gt;A computer science analogy comes from Brooks' quote adapted for Object Oriented programming by Raymond:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Show me your code without your [classes] and I won't understand. Show me your classes without your code, and I won't need to see the code.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I believe the analogy holds for simulation papers and images. A simulation paper without images will either be unintelligible or far too long to read. A good set of images can show the ideas and key content behind the paper without needing the paper.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Result of a pyro simulation" src="https://raw.githubusercontent.com/IanHawke/im2sim/master/example_figure/plot.png" /&gt;&lt;/p&gt;
&lt;p&gt;So, &lt;strong&gt;the image is the simulation&lt;/strong&gt;. And this is a &lt;em&gt;big&lt;/em&gt; problem.&lt;/p&gt;
&lt;h2&gt;The image as orphan&lt;/h2&gt;
&lt;p&gt;Hyperbole aside, images - unlike in-depth academic arguments - aren't confined to papers. Everywhere the work might be advertised - talks, websites, grant proposals and more - the image is doing much of the work: representing the simulation, standing in for the months of code wrangling and contentious analysis. That image that appeared on a student poster might, in a few years, be the key figure selling a grant proposal, or illustrating a research lab's work, or holding together a chapter of a thesis, or representing to another scientist all that is wrong (or right) about another field of research. How many problems result from people arguing about what they &lt;em&gt;think&lt;/em&gt; a result means, thanks to arguing with the figure out of context, and the original context (code and analysis) can't easily be reproduced?&lt;/p&gt;
&lt;p&gt;There is a link to be made with the amazing "artists' impressions" that NASA produces, often to illustrate new observational results. They're incredible feats that condense the state of the art science into easily grasped images. However, it's always clear that these aren't real. When the image is from a computer simulation, which is meant to be a cutting-edge model of how things "really" are, then it can have disproportionate impact on scientists and non-scientists when pulled out of context.&lt;/p&gt;
&lt;h2&gt;im2sim&lt;/h2&gt;
&lt;p&gt;One way to tackle this is to make the image &lt;em&gt;really&lt;/em&gt; represent the simulation, by making it possible to &lt;em&gt;replicate&lt;/em&gt; the full simulation (code, parameter files, data analysis scripts and all) just from the figure. Note that I'm using &lt;a href="http://reproduciblescience.blogspot.co.uk/2015/05/rebility.html"&gt;this definition&lt;/a&gt; of replicability versus reproducibility, even though I've loosely used reproducibility throughout this post. If the details are embedded in the figure metadata, in such a way that the simulation can be &lt;em&gt;easily&lt;/em&gt; recovered, then it would be possible to link the figure with its original context in a reproducible way.&lt;/p&gt;
&lt;p&gt;Here's an example, using the figure at the top of the page. To reproduce this figure, you'll need the &lt;code&gt;im2sim&lt;/code&gt; code from &lt;a href="http://ianhawke.github.com/im2sim"&gt;this github repository&lt;/a&gt;, which is a simple &lt;code&gt;python&lt;/code&gt; script, and the figure itself, which you can just "save as" directly from this page.&lt;/p&gt;
&lt;p&gt;The idea I've used here is the simplest hack I could think of that would give the entire simulation. The metadata of the image contains the SHA1 hash of a &lt;code&gt;docker&lt;/code&gt; container stored on &lt;a href="http://hub.docker.com"&gt;dockerhub&lt;/a&gt;. This container includes the code to produce it (in this case, &lt;code&gt;pyro2&lt;/code&gt;, which is Mike Zingale's code illustrating a number of CFD techniques) and a Makefile. &lt;code&gt;im2sim reproduce&lt;/code&gt; will (assuming you have &lt;code&gt;docker&lt;/code&gt; installed) pull the container, then tell you the command you need to run to reproduce the images, or the command to use to inspect the content of the container.&lt;/p&gt;
&lt;p&gt;The alternative use of the script can be illustrated once you have the container associated with the image. &lt;code&gt;im2sim mark&lt;/code&gt; can be called &lt;em&gt;on the container&lt;/em&gt;. This will run the Makefile in the container, produce the images, and then edit the metadata of the images to include the SHA1 hash. Those images can then be distributed, and anyone can reproduce the simulation using just the image and the &lt;code&gt;im2sim&lt;/code&gt; script.&lt;/p&gt;
&lt;h2&gt;Is this for everyone?&lt;/h2&gt;
&lt;p&gt;Let me rephrase that: should you download a script and image from the internet and run it on your machine, knowing that effective use of &lt;code&gt;docker&lt;/code&gt; requires root permission on your machine? The answer is obviously, "&lt;em&gt;No, you should not use this code!&lt;/em&gt;".&lt;/p&gt;
&lt;p&gt;However, building something like this into your workflow &lt;em&gt;would&lt;/em&gt; be a good idea. If you've already got a reproducible workflow then adding the metadata that gets back to the last analysis step producing the figures would be enough. Adding a link to, for example, a Jupyter notebook that produces the figure whilst explaining the analysis would be better. Any way that works!&lt;/p&gt;
&lt;h6&gt;Acknowledgements&lt;/h6&gt;
&lt;p&gt;The code to add the metadata to image files was &lt;a href="https://github.com/dfm/savefig"&gt;taken from this code&lt;/a&gt;. It monkey-patches &lt;code&gt;matplotlib&lt;/code&gt; to add the git hash of the local directory to the figure produced. This builds the reproducibility aspect into the workflow more naturally, and would be a better approach in many ways - it ensures the image automatically gets the metadata - but unlike the docker approach it doesn't contain the full workflow.&lt;/p&gt;
&lt;p&gt;The setup of the &lt;code&gt;docker&lt;/code&gt; container comes from &lt;a href="http://stackoverflow.com/a/26547845/3112941"&gt;this stackoverflow answer&lt;/a&gt; which references &lt;a href="https://github.com/marmelab/make-docker-command/blob/master/Makefile"&gt;this Makefile&lt;/a&gt;. I've taken the approach but switched to python simplly to use one script for the lot.&lt;/p&gt;
&lt;p&gt;Mike Zingale's &lt;code&gt;pyro2&lt;/code&gt; code covers a lot more than I've shown here. It's an excellent learning resource, especially used in conjunction with &lt;a href="https://github.com/Open-Astrophysics-Bookshelf/numerical_exercises"&gt;his detailed notes&lt;/a&gt;.&lt;/p&gt;</summary><category term="Reproducibility"></category></entry><entry><title>Close Enough Part 4</title><link href="http://IanHawke.github.io/blog/close-enough-part-4.html" rel="alternate"></link><updated>2015-04-15T09:40:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-04-15:blog/close-enough-part-4.html</id><summary type="html">&lt;!-- the next line is the key to include the notebook here: --&gt;

&lt;p&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In &lt;a href="http://software-carpentry.org/blog/2014/10/why-we-dont-teach-testing.html"&gt;Greg&amp;#39;s original post&lt;/a&gt; he specifically references the &lt;a href="http://benchmarksgame.alioth.debian.org/u32/program.php?test=nbody&amp;amp;lang=python3&amp;amp;id=1"&gt;Python 3 version&lt;/a&gt; of the &lt;a href="http://benchmarksgame.alioth.debian.org/u32/performance.php?test=nbody"&gt;n-body benchmark&lt;/a&gt;. In particular, he asks how to test the &lt;code&gt;advance&lt;/code&gt; function. &lt;/p&gt;
&lt;p&gt;There&amp;#39;s a number of useful and important comments underneath the original post, in particular &lt;a href="http://software-carpentry.org/blog/2014/10/why-we-dont-teach-testing.html#comment-1662471640"&gt;this thread on details of the algorithm and the problems with the code&lt;/a&gt;, but here we&amp;#39;ll start from scratch.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#39;s reproduce that code here (please note the &lt;a href="http://benchmarksgame.alioth.debian.org/license.html"&gt;OSI BSD license&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.family&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;serif&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="c"&gt;# The Computer Language Benchmarks Game&lt;/span&gt;
&lt;span class="c"&gt;# http://benchmarksgame.alioth.debian.org/&lt;/span&gt;
&lt;span class="c"&gt;#&lt;/span&gt;
&lt;span class="c"&gt;# originally by Kevin Carson&lt;/span&gt;
&lt;span class="c"&gt;# modified by Tupteq, Fredrik Johansson, and Daniel Nanz&lt;/span&gt;
&lt;span class="c"&gt;# modified by Maciej Fijalkowski&lt;/span&gt;
&lt;span class="c"&gt;# 2to3&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; 

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

&lt;span class="n"&gt;PI&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;3.14159265358979323&lt;/span&gt;
&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;PI&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;PI&lt;/span&gt;
&lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;365.24&lt;/span&gt;

&lt;span class="n"&gt;BODIES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s"&gt;&amp;#39;sun&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;

    &lt;span class="s"&gt;&amp;#39;jupiter&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;4.84143144246472090e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.16032004402742839e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.03622044471123109e-01&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.66007664274403694e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="mf"&gt;7.69901118419740425e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.90460016972063023e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="mf"&gt;9.54791938424326609e-04&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;

    &lt;span class="s"&gt;&amp;#39;saturn&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;8.34336671824457987e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="mf"&gt;4.12479856412430479e+00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.03523417114321381e-01&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
               &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.76742510726862411e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="mf"&gt;4.99852801234917238e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="mf"&gt;2.30417297573763929e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
               &lt;span class="mf"&gt;2.85885980666130812e-04&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;

    &lt;span class="s"&gt;&amp;#39;uranus&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.28943695621391310e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.51111514016986312e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.23307578892655734e-01&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
               &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.96460137564761618e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="mf"&gt;2.37847173959480950e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.96589568540237556e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
               &lt;span class="mf"&gt;4.36624404335156298e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;

    &lt;span class="s"&gt;&amp;#39;neptune&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.53796971148509165e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.59193146099879641e+01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="mf"&gt;1.79258772950371181e-01&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.68067772490389322e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="mf"&gt;1.62824170038242295e-03&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;9.51592254519715870e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;DAYS_PER_YEAR&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="mf"&gt;5.15138902046611451e-05&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="n"&gt;SYSTEM&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BODIES&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;PAIRS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;PAIRS&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(([&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
             &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;v2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;
            &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;y2&lt;/span&gt;
            &lt;span class="n"&gt;dz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;z1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;z2&lt;/span&gt;
            &lt;span class="n"&gt;mag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dz&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="n"&gt;b1m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mag&lt;/span&gt;
            &lt;span class="n"&gt;b2m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mag&lt;/span&gt;
            &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b2m&lt;/span&gt;
            &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b2m&lt;/span&gt;
            &lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;dz&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b2m&lt;/span&gt;
            &lt;span class="n"&gt;v2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b1m&lt;/span&gt;
            &lt;span class="n"&gt;v2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b1m&lt;/span&gt;
            &lt;span class="n"&gt;v2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dz&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;b1m&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;vx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vz&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;vx&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;vy&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;vz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now, there&amp;#39;s a number of issues with this code, as noted in &lt;a href="http://software-carpentry.org/blog/2014/10/why-we-dont-teach-testing.html"&gt;comments on the original post&lt;/a&gt;. Instead of addressing those here, I&amp;#39;ll point to Konrad Hinsen&amp;#39;s upcoming article on testing (to appear in CiSE in July), or &lt;a href="http://physics.codes/"&gt;Scopatz and Huff&amp;#39;s book&lt;/a&gt;, both of which discuss n-body codes, testing, and how to code them effectively. Also, we&amp;#39;re only interested in testing whether the implementation is &amp;quot;correct&amp;quot;, not the limitations of that implementation for modelling the physics: Konrad Hinsen points me to &lt;a href="http://www.comp-astrophys-cosmol.com/content/2/1/2/abstract"&gt;this paper by Boekholt and Portegies Zwart&lt;/a&gt; on testing n-body code for their &lt;em&gt;reliability&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;In previous notebooks we compared the results of the algorithm with the expected behaviour within the context of a &lt;em&gt;model&lt;/em&gt;. The model only considered the behaviour of the numerical algorithm: we took it for granted that the correct physics had been implemented. In this case, the &lt;code&gt;advance&lt;/code&gt; function is doing two things, neither of which are immediately obvious:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;it evaluates the forces due to gravitational interaction between all of the particles, and&lt;/li&gt;
&lt;li&gt;it evolves the system of particles forwards in time.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In testing whether the results are &lt;em&gt;close enough&lt;/em&gt;, we need to test within the context of &lt;em&gt;two&lt;/em&gt; models: we need to check that the correct physics is implemented, and we need to check that the numerical evolution behaves as expected.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="The-models"&gt;The models&lt;a class="anchor-link" href="#The-models"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The physics that we&amp;#39;re modelling is the &lt;a href="http://en.wikipedia.org/wiki/N-body_problem"&gt;classical n body problem&lt;/a&gt; of massive particles interacting only through gravity. The &lt;a href="http://en.wikipedia.org/wiki/N-body_problem#General_formulation"&gt;general formulation&lt;/a&gt; gives the equations of motion&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  m_i \frac{d^2 \vec{r}_i}{d t^2} = \sum_{j \ne i} \frac{ G m_i m_j (\vec{r}_j - \vec{r}_i) }{|\vec{r}_j - \vec{r}_i|^3}
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;where $m_i, \vec{r}_i$ are the masses and positions of the $i^{\text{th}}$ particle. This model is Newton&amp;#39;s laws (which are equivalent to the conservation of energy and momentum) plus Newton&amp;#39;s law of gravity.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The numerical method we need to model uses the &lt;a href="http://en.wikipedia.org/wiki/Semi-implicit_Euler_method"&gt;&lt;em&gt;semi-implicit Euler method&lt;/em&gt;&lt;/a&gt;&lt;sup id="fnref:1"&gt;&lt;a href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt; to update in time, and a &lt;a href="http://en.wikipedia.org/wiki/N-body_problem#Few_bodies"&gt;direct particle-particle method&lt;/a&gt; to compute the spatial interactions. The semi-implicit Euler method is first order accurate (with respect to the timestep $\Delta t$), and the particle-particle interactions are exact.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That is, we can think of the algorithm as solving the ODE&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \frac{d y}{dt} = F(t, y)
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;where the vector $y$ contains the positions $\vec{r}$ and velocities $\vec{v}$ of each body. Due to the physics of the problem (ie, there&amp;#39;s a total energy that we want to conserve) there&amp;#39;s an advantage in considering the positions and velocities separately, but when it comes to measure the error we don&amp;#39;t need to do that: we just treat the &lt;code&gt;advance&lt;/code&gt; function as an algorithm that takes the full vector $y_n$ as input and returns $y_{n+1}$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;What this means in practical terms is that we expect the error in time to have similar convergence rate behaviour to the standard Euler method discussed before: the convergence rate should be $1$, which can be checked both by the self-convergence being within $0.585$ and $1.585$, and also that the error in the convergence rate goes down by at least $1/3$ as the base resolution of $\Delta t$ is reduced by $2$. Checking the local truncation error would require more detailed analysis, but in principle should follow the same steps as before.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;What&amp;#39;s more interesting here is the additional checks from the complexities of the particle-particle interaction. We can use our previous techniques to check that the time update algorithm is behaving as expected. However, the particle-particle interaction itself contains many steps, and those also need testing.&lt;/p&gt;
&lt;p&gt;Let&amp;#39;s check the output on (a copy of) the default input, taking a &lt;em&gt;single&lt;/em&gt; step.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;copy&lt;/span&gt;
&lt;span class="n"&gt;bodies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
[([1.598379730131437e-07, -3.018779686495645e-08, -3.730115986360403e-09], [1.598379730131437e-05, -3.018779686495645e-06, -3.7301159863604027e-07], 39.47841760435743), ([8.333218184594687, 4.1430349688596575, -0.40343728476075313], [-1.0148533649892928, 1.8236404735352374, 0.00861323535682711], 0.011286326131968767), ([4.847339930856543, -1.1321630550460413, -0.10387091638393478], [0.5908488391821772, 2.8156988981387063, -0.02488719128116714], 0.03769367487038949), ([15.389485801827046, -25.913363875177772, 0.17891118741867673], [0.9788686976130451, 0.5950734810190818, -0.034758553169444574], 0.0020336868699246304), ([12.905190971986693, -15.102456648865521, -0.22341579268383283], [1.0821409847561863, 0.8694752833109706, -0.010821379117708814], 0.0017237240570597112)]
[([0.0, 0.0, 0.0], [0.0, 0.0, 0.0], 39.47841760435743), ([8.34336671824458, 4.124798564124305, -0.4035234171143214], [-1.0107743461787924, 1.8256623712304119, 0.008415761376584154], 0.011286326131968767), ([4.841431442464721, -1.1603200440274284, -0.10362204447112311], [0.606326392995832, 2.81198684491626, -0.02521836165988763], 0.03769367487038949), ([15.379697114850917, -25.919314609987964, 0.17925877295037118], [0.979090732243898, 0.5946989986476762, -0.034755955504078104], 0.0020336868699246304), ([12.894369562139131, -15.111151401698631, -0.22330757889265573], [1.0827910064415354, 0.8687130181696082, -0.010832637401363636], 0.0017237240570597112)]

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Comparing these two is going to be a real pain. So, let&amp;#39;s create a utility function that will give the difference between two configurations of bodies. It will return the differences in the locations and the velocities as arrays, but will also include the &amp;quot;total&amp;quot; error as a single number - the sum of the absolute values of all errors. If this norm is zero then the two configurations are identical.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Compare two configurations.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Configurations must have same number of bodies! {}, {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;d_positions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;d_velocities&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;norm_difference&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;d_positions&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;d_velocities&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;norm_difference&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d_positions&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d_velocities&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;norm_difference&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_positions&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_velocities&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;norm1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;d_v&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;


&lt;div class="output_text output_subarea output_pyout"&gt;
&lt;pre&gt;
array([[  1.59837973e-05,  -3.01877969e-06,  -3.73011599e-07],
       [ -4.07901881e-03,  -2.02189770e-03,   1.97473980e-04],
       [ -1.54775538e-02,   3.71205322e-03,   3.31170379e-04],
       [ -2.22034631e-04,   3.74482371e-04,  -2.59766537e-06],
       [ -6.50021685e-04,   7.62265141e-04,   1.12582837e-05]])
&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now we have to think about how to test the particle-particle interaction. The parameter we can change in order to do the test is the configuration &lt;code&gt;bodies&lt;/code&gt; (and the associated list of &lt;code&gt;pairs&lt;/code&gt;, which we&amp;#39;ll always take to be &lt;code&gt;combinations(bodies)&lt;/code&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So we can either change the positions, or the velocities, of the bodies, or their masses (or some combination of the three). What changes make meaningful tests?&lt;/p&gt;
&lt;p&gt;Well, the coordinates chosen should not matter, &lt;em&gt;if&lt;/em&gt; we change them in a self-consistent way, &lt;em&gt;and&lt;/em&gt; interpret the results appropriately. For example, if we &lt;em&gt;ran time backwards&lt;/em&gt; by changing the direction of time (&lt;code&gt;dt&lt;/code&gt; $\to$ &lt;code&gt;-dt&lt;/code&gt;) and changing the sign of the velocities, then the results should be identical (after re-flipping the direction of time).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;flip_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Flip the time by flipping the velocity.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;bodies_flip_time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;flip_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_time&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_time&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;flip_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_time&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;norm_flip_time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x_flip_time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v_flip_time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies_flip_time&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Norm of differences is {}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm_flip_time&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Norm of differences is 0.0.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As expected, the positions are identical. Note that the velocities are significantly different, because they still have the opposite sign, but if we flip the velocities back as well, then they will be identical.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Why did we do this? Because one of the first steps in debugging, and hence in testing, should be to &lt;a href="http://software-carpentry.org/v5/novice/python/05-defensive.html#know-what-its-supposed-to-do"&gt;check the conservation laws&lt;/a&gt;. This is just an example of a conservation law resulting from a symmetry: the consequence of &lt;a href="http://en.wikipedia.org/wiki/Noether&amp;#39;s_theorem"&gt;Emmy Noether&amp;#39;s famous theorem&lt;/a&gt;. There is a &lt;a href="http://en.wikipedia.org/wiki/Symmetry_(physics)#Conservation_laws_and_symmetry"&gt;detailed list&lt;/a&gt; of symmetries that a physical theory could have, each of which has an associated conservation law. Not all physical models obey all symmetries, and not every numerical  simulation obeys all the symmetries of the physical model (maybe due to boundary conditions, or numerical approximations). However, in the n-body case we expect a large number of these symmetries to hold, which we can check.&lt;/p&gt;
&lt;p&gt;These include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;discrete parity symmetry (sending $\vec{r} \to -\vec{r}$)&lt;/li&gt;
&lt;li&gt;discrete time symmetry (sending $t \to -t$)&lt;/li&gt;
&lt;li&gt;discrete charge symmetry (not relevant here - no charges)&lt;/li&gt;
&lt;li&gt;continuous space translation ($\vec{r} \to \vec{r} + \vec{a}$)&lt;/li&gt;
&lt;li&gt;continuous space rotation&lt;/li&gt;
&lt;li&gt;continuous time translation (this is obeyed by the continuum model, but not by the numerical model)&lt;/li&gt;
&lt;li&gt;continuous conformal (like) symmetry ($t \to b t$, $\vec{r} \to b \vec{r}$, and $m \to b m$ all together).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In the first test where we &amp;quot;ran time in reverse&amp;quot; we were checking discrete time symmetry. We can now check the other symmetries systematically.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Discrete-space-symmetry"&gt;Discrete space symmetry&lt;a class="anchor-link" href="#Discrete-space-symmetry"&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We should be able to flip individual coordinates: if $y \to -y$ and $v_y \to -v_y$, for example, then  the evolution of the other coordinates and velocities should be unaffected (and if this flip is reversed after evolution, the position should be identical).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;flip_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Flip a single coordinate direction&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;
        &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;flip_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;flip_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;norm_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v_flip_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies_flip_coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Norm of differences is {} (flipped coordinate {}).&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm_flip_coord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Norm of differences is 0.0 (flipped coordinate 0).
Norm of differences is 0.0 (flipped coordinate 1).
Norm of differences is 0.0 (flipped coordinate 2).

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Continuous-space-translation"&gt;Continuous space translation&lt;a class="anchor-link" href="#Continuous-space-translation"&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Next, note that only the &lt;em&gt;separation&lt;/em&gt; between bodies is meant to matter. So if we arbitrarily translate all coordinates by some amount whilst leaving the velocities untouched, and reverse this after evolution, the result should be identical.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;translate_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Translate the coordinates of all bodies&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;shift&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c"&gt;# Random coordinate shift in [-5, 5]&lt;/span&gt;
&lt;span class="n"&gt;bodies_shift&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;translate_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_shift&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_shift&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_shift&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;translate_coordinate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_shift&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;norm_shift&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x_shift&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v_shift&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies_shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Norm of differences is {}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm_shift&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Norm of differences is 2.65582528796e-15.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In this case the repeated operations introduce some floating point round-off error. This should be related to the round off introduced by the shift, and bounded by the number of bodies ($5$) multiplied by the total round-off introduced:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spacing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;


&lt;div class="output_text output_subarea output_pyout"&gt;
&lt;pre&gt;
5.0653925498522767e-15
&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The precise differences are:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d_x_shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d_v_shift&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
[[  3.14177755e-18   2.85959236e-16   7.50034688e-18]
 [  0.00000000e+00   0.00000000e+00  -1.11022302e-16]
 [  0.00000000e+00   4.44089210e-16  -2.77555756e-17]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   1.77635684e-15   0.00000000e+00]]
[[ 0.  0.  0.]
 [ 0.  0.  0.]
 [ 0.  0.  0.]
 [ 0.  0.  0.]
 [ 0.  0.  0.]]

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We see that the some of the bodies have errors around the expected floating point limit, and these dominate the resulting error (which is well within the expected bound).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Continuous-space-rotation"&gt;Continuous space rotation&lt;a class="anchor-link" href="#Continuous-space-rotation"&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Yet another coordinate transformation can be tried without affecting the results: a rotation. We&amp;#39;ll pick three random Euler angles and &lt;a href="http://en.wikipedia.org/wiki/Rotation_matrix#In_three_dimensions"&gt;set up the rotation matrix&lt;/a&gt;. In general, we should do a translation first to ensure no body is at the origin (here, the Sun will be), to avoid specializing the problem, but given the generality of the code that&amp;#39;s a very minor worry.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;rotate_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;invert&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Rotate the coordinates of all bodies.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="n"&gt;Rx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])]])&lt;/span&gt;
    &lt;span class="n"&gt;Ry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])]])&lt;/span&gt;
    &lt;span class="n"&gt;Rz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;invert&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Ry&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Rz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;R&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Rz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ry&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;xp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;vp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;angles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Random Euler angles in [0, pi/4]&lt;/span&gt;
&lt;span class="n"&gt;bodies_rotate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rotate_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_rotate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_rotate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_rotate&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;rotate_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_rotate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;invert&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;norm_rotate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x_rotate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v_rotate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies_rotate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Norm of differences is {}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm_rotate&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Norm of differences is 2.93168523701e-15.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The size of the differences is considerably larger, thanks to the number of operations performed. With three rotation matrices combined, each containing nine entries, applied to five bodies, we would expect a total error of the order of:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spacing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;angles&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[17]:&lt;/div&gt;


&lt;div class="output_text output_subarea output_pyout"&gt;
&lt;pre&gt;
1.1709383462843448e-14
&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="Continuous-conformal-(like)-symmetry"&gt;Continuous conformal (like) symmetry&lt;a class="anchor-link" href="#Continuous-conformal-(like)-symmetry"&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We could also try scaling the coordinates and the masses. As the &lt;a href="http://en.wikipedia.org/wiki/N-body_problem#General_formulation"&gt;force goes as&lt;/a&gt; $M^2/L^2$, if we scale time, position and mass by the same amount then the results should not change. Note that because we scale &lt;em&gt;both&lt;/em&gt; length and time, the velocity does not change.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;scale_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Scale coordinates and masses.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="n"&gt;bodies_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;new_x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;new_v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;new_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;new_x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*=&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;
        &lt;span class="n"&gt;bodies_scale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;new_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_m&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;bodies_scale&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;
&lt;span class="n"&gt;bodies_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scale_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.02&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_scale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_scale&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;bodies_rescale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scale_bodies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_scale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;norm_scale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_x_scale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d_v_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies_rescale&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Norm of differences is {}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm_scale&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Norm of differences is 0.0.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This scaling does not &lt;em&gt;prove&lt;/em&gt; that the force goes as $M^2/L^2$; it only shows that the force contains $M$ and $L$ to the same power. To show that it&amp;#39;s got the appropriate form we should either &lt;a href="http://software-carpentry.org/v5/novice/python/05-defensive.html#know-what-its-supposed-to-do"&gt;compare to an oracle or test simpler cases&lt;/a&gt;. The &lt;a href="http://benchmarksgame.alioth.debian.org/u32/benchmark.php?test=nbody&amp;amp;lang=java"&gt;Java n-body code&lt;/a&gt; is (likely) the oracle it was tested against; testing against a simpler case will be done later.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Convergence---continuous-time-translation"&gt;Convergence - continuous time translation&lt;a class="anchor-link" href="#Convergence---continuous-time-translation"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Above, we noted that continuous time translation (which corresponds to conservation of energy) may not be perfectly retained by our &lt;em&gt;numerical method&lt;/em&gt;, even though it is perfectly preserved by the theory. However, as we&amp;#39;re solving an ODE in time, we can use the techniques applied to the phugoid model to ensure the numerical method is converging at the expected rate. As we&amp;#39;re expecting the method to converge at first order, we need the error in the measured self-convergence rate to reduce by at least $1/3$ when the resolution (in time) is reduced by $2$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt; &lt;span class="c"&gt;# The base resolution will take 1000 steps&lt;/span&gt;
&lt;span class="n"&gt;dt_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;bodies_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;bodies_loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bodies_loop&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_loop&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;bodies_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_loop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;convergence_rate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;numerator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;diff_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;diff_v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;bodies_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;denominator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;diff_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;diff_v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;differences&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodies_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;bodies_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numerator&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denominator&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Convergence rate (base dt={}) is {} (error {}).&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Is the convergence rate close enough to 1 for the answers to match? {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Does the convergence of the convergence rate show it&amp;#39;s close enough to 1? {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;convergence_rate&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Convergence rate (base dt=0.01) is 0.996457140741 (error 0.00354285925877).
Convergence rate (base dt=0.005) is 0.998222719909 (error 0.00177728009084).
Is the convergence rate close enough to 1 for the answers to match? True
Does the convergence of the convergence rate show it&amp;apos;s close enough to 1? True

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This shows that the time evolution is close enought to first order as expected. We haven&amp;#39;t explicitly shown that it&amp;#39;s the semi-implicit Euler method, as explicitly calculating the local truncation error would be a lot of work, and in this case we&amp;#39;re really not interested in the specific time integration scheme - just that it converges.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Checking-the-specific-force-law"&gt;Checking the specific force law&lt;a class="anchor-link" href="#Checking-the-specific-force-law"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In order to check that we&amp;#39;ve really implemented Newton&amp;#39;s law of gravity, we need to test a very simplified situation where we can predict the precise answer. Let&amp;#39;s set up a two body problem starting from rest.&lt;/p&gt;
&lt;p&gt;Once we&amp;#39;ve done that, we can vary one parameter and check that the acceleration behaves as expected. The two cases we have are varying a mass, so that if $m_1 \to b m_1$ then&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2(b) = b \vec{a_2}(1)
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;and varying separation $|\vec{r}_1 - \vec{r}_2|$ so that $|\vec{r}_1 - \vec{r}_2| \to c |\vec{r}_1 - \vec{r}_2|$&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2(c) =  c^{-2} \vec{a}(1).
\end{equation}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Over a single timestep $\Delta t$ we can approximate the acceleration as&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2(t=0) \simeq \frac{\vec{v}_2(t=\Delta t) - \vec{v}_2(t=0)}{\Delta t}.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;For &lt;em&gt;this specific algorithm&lt;/em&gt; we have that &lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
   \vec{v}_2(t=\Delta t) = \vec{v}_2(t=0) + \Delta t \, \vec{a}_2(t=0),
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;which means that the approximation for the acceleration is, in fact, exact:&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2(t=0) = \frac{\vec{v}_2(t=\Delta t) - \vec{v}_2(t=0)}{\Delta t}.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;For a general algorithm we would have a first order in $\Delta t$ error in our approximation to the acceleration, so would have to use Richardson extrapolation methods as before in order to calculate the acceleration, and hence check the force.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;body_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;body_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;body_1_2_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;body_1_2_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;two_bodies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;two_bodies_2_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_1_2_separation&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;two_bodies_2_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_1_2_mass&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_separation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_separation&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_mass&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_mass&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;The acceleration (hence velocity) should decrease as separation^2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;So these two numbers should match: {} {} (difference: {})&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
        &lt;span class="n"&gt;two_bodies_2_separation&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_separation&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;The acceleration (hence velocity) should increase as mass^1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;So these two numbers should match: {} {} (difference: {})&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
        &lt;span class="n"&gt;two_bodies_2_mass&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;two_bodies_2_mass&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
The acceleration (hence velocity) should decrease as separation^2
So these two numbers should match: 0.00986960440109 0.00986960440109 (difference: 0.0)
The acceleration (hence velocity) should increase as mass^1
So these two numbers should match: 0.00986960440109 0.00986960440109 (difference: 0.0)

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Of course, we could have just got (un)lucky in comparing single data points when we vary either $b$ or $c$. Instead we can choose a set of points at random, and fit to a more general model; for example, fit to&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2 (b) = \sum_{i=0}^4 p_i b^i
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \vec{a}_2 (c) = \sum_{i=0}^4 p_i c^{-i}:
\end{equation}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[23]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;bodies_list_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;separation_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;separations&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;separation_scale&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;span class="n"&gt;separation_v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;separations&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;separation_scale&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;body_1_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;two_bodies_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_1_separation&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;two_bodies_separation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_separation&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;bodies_list_separation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_separation&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;separation_v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;two_bodies_separation&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    
&lt;span class="n"&gt;bodies_list_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;mass_scale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;masses&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mass_scale&lt;/span&gt;
&lt;span class="n"&gt;mass_v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;masses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scale&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mass_scale&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;body_1_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;scale&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;SOLAR_MASS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;two_bodies_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_1_mass&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deepcopy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body_2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="n"&gt;advance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;two_bodies_mass&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pairs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;combinations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_mass&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;bodies_list_mass&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;two_bodies_mass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;mass_v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;two_bodies_mass&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[24]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;p_separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;polyfit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;separations&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;separation_v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;separations&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;p_mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;polyfit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;masses&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mass_v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;masses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;We expect the third-to-last (separation^{-2}) coefficient to dominate:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Coefficients from separation: {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_separation&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Coefficient of separation^{{-2}}: {:.5g}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_separation&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Largest other coefficient: {:.5g}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_separation&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)))))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;We expect the second-to-last (mass^{1}) coefficient to dominate:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Coefficients from mass: {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_mass&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Coefficient of mass^{{1}}: {:.5g}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_mass&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Largest other coefficient: {:.5g}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p_mass&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
We expect the third-to-last (separation^{-2}) coefficient to dominate:
Coefficients from separation: [ -1.23658983e-13   3.37053840e-13   3.94784176e-02   1.52064406e-13
  -2.51860848e-14]
Coefficient of separation^{-2}: 0.039478
Largest other coefficient: 3.3705e-13
We expect the second-to-last (mass^{1}) coefficient to dominate:
Coefficients from mass: [ -1.49647348e-10   3.70891390e-11  -3.28036188e-12   9.86960440e-02
  -1.64884876e-15]
Coefficient of mass^{1}: 0.098696
Largest other coefficient: 1.4965e-10

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We we see that the expected coefficient dominates, but we&amp;#39;re not getting a fit that&amp;#39;s absolutely perfect. This is likely due to the limitations of the fitting algorithm.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, we have an algorithm that&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;obeys all the expected symmetries;&lt;/li&gt;
&lt;li&gt;depends on the size of the separation and the mass only;&lt;/li&gt;
&lt;li&gt;scales as expected with mass and separation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This strongly suggests that it implements Newton&amp;#39;s laws, and the force term that&amp;#39;s implemented has the form&lt;/p&gt;
&lt;p&gt;$$
  \vec{F} = G \frac{m_1 m_2 (\vec{r}_2 - \vec{r}_1)}{|\vec{r}_2 - \vec{r}_1|^3}.
$$&lt;/p&gt;
&lt;p&gt;The only remaining question: is the value of $G$ correct?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Our previous calculations give us the value of $G$ internal to the algorithm; we just take our value for the acceleration $\vec{a}_2 = \vec{F}/m_2$ and take out the masses and separations:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[25]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.01&lt;/span&gt;
&lt;span class="n"&gt;separation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;
&lt;span class="n"&gt;mass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;
&lt;span class="n"&gt;G&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;two_bodies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;separation&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt; 
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Algorithm G, in units of AU^3 SolarMass^{{-1}} years^{{-2}}: {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Algorithm G, in units of AU^3 SolarMass^{-1} years^{-2}: 39.4784176044

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[26]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;constants&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Accepted value of G, in units of {}: {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;constants&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Newtonian constant of gravitation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
        &lt;span class="n"&gt;constants&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Accepted value of G, in units of m^3 kg^-1 s^-2: 6.67384e-11

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[27]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;solar_mass_in_kg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.9891e30&lt;/span&gt;
&lt;span class="n"&gt;year_in_seconds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;3.15569e7&lt;/span&gt;
&lt;span class="n"&gt;AU_in_metres&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;149597870700.0&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Algorithm G, in units of m^3 kg^-1 s^-2: {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AU_in_metres&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solar_mass_in_kg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;year_in_seconds&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Algorithm G, in units of m^3 kg^-1 s^-2: 6.67253235347e-11

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So the constants agree to three significant figures. Noting that the conversion factors used are only given to five or six significant figures, and the &lt;a href="http://en.wikipedia.org/wiki/Gravitational_constant#Laws_and_constants"&gt;experimental uncertainty&lt;/a&gt; in the value of the gravitational constant, I would say this check is close enough.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h5 id="Footnotes"&gt;Footnotes&lt;a class="anchor-link" href="#Footnotes"&gt;&amp;#182;&lt;/a&gt;&lt;/h5&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;div class="footnotes"&gt;&lt;ol&gt;
    &lt;li class="footnote" id="fn:1"&gt;
        &lt;p&gt;The method that got me to this conclusion is a classic &lt;em&gt;just Google it&lt;/em&gt; style, as follows. Looking at the original n-body example there&amp;#39;s no useful documentation, but the &lt;a href="http://benchmarksgame.alioth.debian.org/u32/performance.php?test=nbody#about"&gt;about section&lt;/a&gt; says that is uses a simple &lt;a href="http://en.wikipedia.org/wiki/Symplectic_integrator"&gt;symplectic integrator&lt;/a&gt;. The &lt;a href="http://en.wikipedia.org/wiki/Symplectic_integrator#A_first-order_example"&gt;first order example&lt;/a&gt; is the &lt;a href="http://en.wikipedia.org/wiki/Semi-implicit_Euler_method"&gt;semi-implicit Euler method&lt;/a&gt;, which appears to match the code. &lt;a href="#fnref:1" title="return to article"&gt; ↩&lt;/a&gt;&lt;p&gt;
    &lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can &lt;a href="http://IanHawke.github.io/blog/notebooks/04-n-body-test.ipynb"&gt;download this notebook&lt;/a&gt;.&lt;/p&gt;</summary><category term="Python"></category><category term="IPython notebook"></category><category term="Testing Scientific Code"></category></entry><entry><title>Close Enough Part 3</title><link href="http://IanHawke.github.io/blog/close-enough-part-3.html" rel="alternate"></link><updated>2015-04-15T09:30:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-04-15:blog/close-enough-part-3.html</id><summary type="html">&lt;!-- the next line is the key to include the notebook here: --&gt;

&lt;p&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;$$
\newcommand{\dt}{\Delta t}
\newcommand{\udt}[1]{u^{({#1})}(T)}
\newcommand{\Edt}[1]{E^{({#1})}}
\newcommand{\uone}[1]{u_{1}^{({#1})}}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is the third in a series of posts on testing scientific software. For this to make sense, you&amp;#39;ll need to have skimmed &lt;a href="http://ianhawke.github.io/blog/close-enough.html"&gt;the motivation and background&lt;/a&gt;. The &lt;a href="http://ianhawke.github.io/blog/close-enough-part-1.html"&gt;first in the series&lt;/a&gt; assumed we only cared about the answer, and whether we&amp;#39;d implemented the expected algorithm wasn&amp;#39;t important. The &lt;a href="http://ianhawke.github.io/blog/close-enough-part-2.html"&gt;second&lt;/a&gt; assumed we cared about the convergence rate of the algorithm, not the specific answer, nor the precise algorithm itself.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In the previous cases we&amp;#39;ve focused on the &lt;em&gt;behaviour&lt;/em&gt; of the algorithm: whether it will give the correct answer in the limit, or whether it converges as expected.  This is really what you want to do: you&amp;#39;re trying to do science, to get an answer, and so implementing the precise algorithm should be secondary.  If you are trying to implement a precise algorithm, it should be because of its (expected) behaviour, and so you should be testing for that!&lt;/p&gt;
&lt;p&gt;However, let&amp;#39;s put that aside and see if we can work out how to test whether we&amp;#39;ve implemented exactly the algorithm we want: Euler&amp;#39;s method. Checking convergence alone is not enough: the &lt;a href="http://en.wikipedia.org/wiki/Backward_Euler_method"&gt;Backwards Euler method&lt;/a&gt; has identical convergence behaviour, as do whole families of other methods. We need a check that characterizes the method uniquely.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The &lt;em&gt;local truncation error&lt;/em&gt; $\Edt{\dt}$ would be exactly such a check. This is the error produced by a single step from exact data, eg&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \Edt{\dt} = u_1 - u(\dt).
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;This is enough as Euler&amp;#39;s method is independent of the data, so each individual step performs the same operations.&lt;/p&gt;
&lt;p&gt;For Euler&amp;#39;s method we have&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  u_{n+1} = u_n + \dt f(t_n, u_n)
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;and so&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \Edt{\dt} = \left| u_0 + \dt f(0, u_0) - u(\dt) \right| =  \left| \frac{\dt^2}{2} \left. u''\right|_{t=0} \right| + {\cal O}(\dt^3).
\end{equation}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is all well and good, but we don&amp;#39;t know the exact solution (in principle) at any point other than $t=0$, so cannot compute $u(\dt)$, so cannot compute $\Edt{\dt}$. We only know $\uone{\dt}$ for whichever values of $\dt$ we wish to compute.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can use repeated Richardson extrapolation to get the solution $u(\dt)$ to sufficient accuracy, however. On the &lt;em&gt;assumption&lt;/em&gt; that the algorithm is first order (we can use the previous techniques to check this), we can use Richardson extrapolation to repeatedly remove the highest order error terms. We can thus find the local truncation errors.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ceil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.family&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;serif&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We will again need the code implementing Euler&amp;#39;s method &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;the full phugoid model notebook&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="c"&gt;# model parameters:&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;9.8&lt;/span&gt;      &lt;span class="c"&gt;# gravity in m s^{-2}&lt;/span&gt;
&lt;span class="n"&gt;v_t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;30.0&lt;/span&gt;   &lt;span class="c"&gt;# trim velocity in m s^{-1}   &lt;/span&gt;
&lt;span class="n"&gt;C_D&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;40.&lt;/span&gt;  &lt;span class="c"&gt;# drag coefficient --- or D/L if C_L=1&lt;/span&gt;
&lt;span class="n"&gt;C_L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;    &lt;span class="c"&gt;# for convenience, use C_L = 1&lt;/span&gt;

&lt;span class="c"&gt;### set initial conditions ###&lt;/span&gt;
&lt;span class="n"&gt;v0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_t&lt;/span&gt;     &lt;span class="c"&gt;# start at the trim velocity (or add a delta)&lt;/span&gt;
&lt;span class="n"&gt;theta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="c"&gt;# initial angle of trajectory&lt;/span&gt;
&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;     &lt;span class="c"&gt;# horizotal position is arbitrary&lt;/span&gt;
&lt;span class="n"&gt;y0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1000.0&lt;/span&gt;  &lt;span class="c"&gt;# initial altitude&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the right-hand side of the phugoid system of equations.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the solution at time n.&lt;/span&gt;
&lt;span class="sd"&gt;        &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    dudt : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the RHS given u.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;C_D&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;C_L&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the solution at the next time-step using Euler&amp;#39;s method.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        solution at the previous time-step.&lt;/span&gt;
&lt;span class="sd"&gt;    f : function&lt;/span&gt;
&lt;span class="sd"&gt;        function to compute the right hand-side of the system of equation.&lt;/span&gt;
&lt;span class="sd"&gt;    dt : float&lt;/span&gt;
&lt;span class="sd"&gt;        time-increment.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    u_n_plus_1 : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        approximate solution at the next time step.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This time we will need lots of solutions in order to measure anything. We will construct ten local truncation errors. For each, we take a single step and store the result for $v$. Then, for each single step result, we use eight other calculations using our algorithm. Each will take multiple, smaller, steps to get a more accurate result for $v$ at the same time. We then use repeated Richardson extrapolation to find, to very high accuracy, the &amp;quot;true&amp;quot; result for $v$ at this time. Finally, we can compare against the original single step results to find the local truncation errors.&lt;/p&gt;
&lt;p&gt;This &lt;em&gt;only&lt;/em&gt; works if the algorithm is converging at the expected rate, as we checked in &lt;a href="http://ianhawke.github.io/blog/close-enough-part-2.html"&gt;the second post&lt;/a&gt;. It does not rely on the algorithm being exactly Euler&amp;#39;s method (thankfully, or the argument would be circular!), but does need the convergence rate to be known.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;T_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;lte_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;dt_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
    &lt;span class="n"&gt;v_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;v_next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;v_next&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v_next&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_next&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_next&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This gives us a set of local truncation errors at given timesteps:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lte&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;For dt={} the local truncation error is {}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lte&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
For dt=0.001 the local truncation error is 1.99954897084e-09.
For dt=0.002 the local truncation error is 8.05573563412e-09.
For dt=0.004 the local truncation error is 3.26825286834e-08.
For dt=0.008 the local truncation error is 1.34407251551e-07.
For dt=0.016 the local truncation error is 5.67045063349e-07.
For dt=0.032 the local truncation error is 2.50349015474e-06.
For dt=0.064 the local truncation error is 1.18961298661e-05.
For dt=0.128 the local truncation error is 6.26360622817e-05.
For dt=0.256 the local truncation error is 0.000370836831557.
For dt=0.512 the local truncation error is 0.00244291651282.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We now have many values for the local truncation error. We can thus compute the convergence rate of the local truncation error itself (which should be two), and check that it is close enough to the expected value using the &lt;a href="http://ianhawke.github.io/blog/close-enough-part-2.html"&gt;same techniques as in the second post in the series&lt;/a&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
                     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Measured convergence rate (base dt {}) is {:.6g} (error is {:.4g}).&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Convergence error has reduced by factor {:.4g}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Measured convergence rate (base dt 0.001) is 2.02375 (error is 0.02375).
Measured convergence rate (base dt 0.002) is 2.04637 (error is 0.04637).
Convergence error has reduced by factor 0.5121.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So the error has gone down considerably, and certainly $0.51 &amp;gt; 1/3$, so the convergence rate of the local truncation error is close enough to 2.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;However, that alone isn&amp;#39;t enough to determine that this really is Euler&amp;#39;s method: as noted above, the convergence rate of the local truncation error isn&amp;#39;t the key point: the key point is that we can predict its &lt;em&gt;actual value&lt;/em&gt; as&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \Edt{\dt} =  \frac{\dt^2}{2} \left| \left. u''\right|_{t=0} \right| + {\cal O}(\dt^3) = \frac{\dt^2}{2} \left| \left( \left. \frac{\partial f}{\partial t} \right|_{t=0} + f(0, u_0) \left. \frac{\partial f}{\partial u} \right|_{t=0, u=u_0} \right) \right|.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;For the specific problem considered here we have&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  u = \begin{pmatrix} v \\ \theta \\ x \\ y \end{pmatrix}, \quad f = \begin{pmatrix} -g\sin \theta - \frac{C_D}{C_L} \frac{g}{v_t^2} v^2 \\ -\frac{g}{v}\cos \theta + \frac{g}{v_t^2} v \\ v \cos \theta \\ v \sin \theta \end{pmatrix}.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;We note that $f$ does not explicitly depend on $t$ (so $\partial f / \partial t \equiv 0$), and that the values of the parameters $g, C_D, C_L$ and $v_t$ are given above, along with the initial data $u_0 = (v_0, \theta_0, x_0, y_0)$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, let&amp;#39;s find what the local truncation error should be.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sympy&lt;/span&gt;
&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_printing&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;v, theta, x, y, g, C_D, C_L, v_t, {\Delta}t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;CD&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CL&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                  &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
                  &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;dfdu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;jacobian&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lte&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dfdu&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;lte_0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lte&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subs&lt;/span&gt;&lt;span class="p"&gt;([(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;9.8&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;vt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;30.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;CD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;40.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;CL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;30.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1000.0&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;lte_0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;


&lt;div class="output_latex output_subarea output_pyout"&gt;
$$\left[\begin{matrix}0.00200083333333333 {\Delta}t^{2}\\- 0.00266777777777778 {\Delta}t^{2}\\- 0.1225 {\Delta}t^{2}\\0\end{matrix}\right]$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So let us check the local truncation error values, which are computed for &lt;code&gt;v&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;lte_exact&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lte_0&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;


&lt;div class="output_text output_subarea output_pyout"&gt;
&lt;pre&gt;
array([ 0.00199955,  0.00201393,  0.00204266,  0.00210011,  0.00221502,
        0.00244481,  0.00290433,  0.003823  ,  0.00565852,  0.00931899])
&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;These are indeed converging towards $0.002 \dt^2$ as they should. To check this quantitatively, we use that our model is&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \Edt{\dt} = \alpha \dt^2 + {\cal O}(\dt^3),
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;with the exact value $\alpha_e \simeq 0.002$. So we can use our usual Richardson extrapolation methods applied to $\Edt{\dt}/\dt^2$, to get a measured value for $\alpha$ with an error interval:&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \alpha_m  = \frac{8\Edt{\dt} - \Edt{2\dt} \pm \left| \Edt{\dt} - \Edt{2\dt} \right|}{4\dt^2}.
\end{equation}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;Edt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;E2dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lte_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;T_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;err1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Edt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;E2dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;a_lo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Edt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;E2dt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;err1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;a_hi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Edt&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;E2dt&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;err1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Base dt={:.4g}: the measured alpha is in [{:.5g}, {:.5g}]&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a_lo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a_hi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Does this contain the exact value? {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;a_lo&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;lte_exact&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a_hi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Base dt=0.001: the measured alpha is in [0.00047112, 0.0034992]
Does this contain the exact value? True
Base dt=0.002: the measured alpha is in [0.00044604, 0.0035244]
Does this contain the exact value? True
Base dt=0.004: the measured alpha is in [0.00039575, 0.0035747]
Does this contain the exact value? True
Base dt=0.008: the measured alpha is in [0.00029522, 0.0036752]
Does this contain the exact value? True
Base dt=0.016: the measured alpha is in [9.4165e-05, 0.0038763]
Does this contain the exact value? True
Base dt=0.032: the measured alpha is in [-0.00030782, 0.0042784]
Does this contain the exact value? True
Base dt=0.064: the measured alpha is in [-0.0011113, 0.0050826]
Does this contain the exact value? True
Base dt=0.128: the measured alpha is in [-0.0027153, 0.0066903]
Does this contain the exact value? True
Base dt=0.256: the measured alpha is in [-0.0059063, 0.0099024]
Does this contain the exact value? True

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, to the limits that we can measure the local truncation error, we have implemented Euler&amp;#39;s method.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can &lt;a href="http://IanHawke.github.io/blog/notebooks/03-Close-Enough-Just-Euler.ipynb"&gt;download this notebook&lt;/a&gt;.&lt;/p&gt;</summary><category term="Python"></category><category term="IPython notebook"></category><category term="Testing Scientific Code"></category></entry><entry><title>Close Enough Part 2</title><link href="http://IanHawke.github.io/blog/close-enough-part-2.html" rel="alternate"></link><updated>2015-04-15T09:20:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-04-15:blog/close-enough-part-2.html</id><summary type="html">&lt;!-- the next line is the key to include the notebook here: --&gt;

&lt;p&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is the second in a series of posts on testing scientific software. For this to make sense, you&amp;#39;ll need to have skimmed &lt;a href="http://ianhawke.github.io/blog/close-enough.html"&gt;the motivation and background&lt;/a&gt;. The &lt;a href="http://ianhawke.github.io/blog/close-enough-part-1.html"&gt;first in the series&lt;/a&gt; assumed we only cared about the answer, and whether we&amp;#39;d implemented the expected algorithm wasn&amp;#39;t important.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;$$
\newcommand{\dt}{\Delta t}
\newcommand{\udt}[1]{u^{({#1})}(T)}
\newcommand{\sm}[1]{s_m^{({#1})}}
$$
Let&amp;#39;s suppose that instead of caring about the answer $u$ we care about the algorithm behaving in the right fashion, $\udt{\dt} = u(T) + c_1 \dt^{s_e}$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Given three pieces of data we can measure the slope:&lt;/p&gt;
&lt;p&gt;$$
\begin{align}
  s_m &amp;amp; = \log_2 \left| \frac{\udt{4\dt}-\udt{2\dt}}{\udt{2\dt}-\udt{\dt}} \right| \\ 
  &amp;amp; = \log_2 \left| \frac{u(T) + c_1 4^{s_e} \dt^{s_e} - u(T) + c_1 2^{s_e} \dt^{s_e} + {\cal O}(\dt^{s_e+1})}{u(T) + c_1 2^{s_e} \dt^{s_e} - u(T) + c_1 \dt^{s_e} + {\cal O}(\dt^{s_e+1)}} \right| \\
  &amp;amp; = \log_2 \left| 2^{s_e} + {\cal O}(\dt) \right| \\
  &amp;amp; = s_e + {\cal O}(\dt).
\end{align}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In the &lt;a href="http://ianhawke.github.io/blog/close-enough-part-1.html"&gt;first post in the series&lt;/a&gt; we applied Richardson extrapolation to the solution, getting an extrapolated answer and an interval within which we expected the true solution to lie. Now we can apply the same Richardson extrapolation tricks to our measured slope. If the measured slope is denoted $\sm{\dt}$ then we can use Richardson extrapolation as before to compute&lt;/p&gt;
&lt;p&gt;$$
\begin{align}
  s_R &amp;amp;= 2\sm{\dt} - \sm{2\dt}, \\ E_R &amp;amp; = s_R - \sm{\dt}.
\end{align}
$$&lt;/p&gt;
&lt;p&gt;We then state that our algorithm is &lt;em&gt;close enough&lt;/em&gt; to correct if $s_e$ lies in the interval $s_R \pm E_R$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ceil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.family&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;serif&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We first need the code implementing Euler&amp;#39;s method &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;the full phugoid model notebook&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="c"&gt;# model parameters:&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;9.8&lt;/span&gt;      &lt;span class="c"&gt;# gravity in m s^{-2}&lt;/span&gt;
&lt;span class="n"&gt;v_t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;30.0&lt;/span&gt;   &lt;span class="c"&gt;# trim velocity in m s^{-1}   &lt;/span&gt;
&lt;span class="n"&gt;C_D&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;40.&lt;/span&gt;  &lt;span class="c"&gt;# drag coefficient --- or D/L if C_L=1&lt;/span&gt;
&lt;span class="n"&gt;C_L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;    &lt;span class="c"&gt;# for convenience, use C_L = 1&lt;/span&gt;

&lt;span class="c"&gt;### set initial conditions ###&lt;/span&gt;
&lt;span class="n"&gt;v0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_t&lt;/span&gt;     &lt;span class="c"&gt;# start at the trim velocity (or add a delta)&lt;/span&gt;
&lt;span class="n"&gt;theta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="c"&gt;# initial angle of trajectory&lt;/span&gt;
&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;     &lt;span class="c"&gt;# horizotal position is arbitrary&lt;/span&gt;
&lt;span class="n"&gt;y0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1000.0&lt;/span&gt;  &lt;span class="c"&gt;# initial altitude&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the right-hand side of the phugoid system of equations.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the solution at time n.&lt;/span&gt;
&lt;span class="sd"&gt;        &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    dudt : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the RHS given u.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;C_D&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;C_L&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the solution at the next time-step using Euler&amp;#39;s method.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        solution at the previous time-step.&lt;/span&gt;
&lt;span class="sd"&gt;    f : function&lt;/span&gt;
&lt;span class="sd"&gt;        function to compute the right hand-side of the system of equation.&lt;/span&gt;
&lt;span class="sd"&gt;    dt : float&lt;/span&gt;
&lt;span class="sd"&gt;        time-increment.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    u_n_plus_1 : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        approximate solution at the next time step.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We then construct a sequence of solutions in order to perform Richardson extrapolation, exactly as in the &lt;a href="http://ianhawke.github.io/blog/close-enough-part-1.html"&gt;first post&lt;/a&gt;. Here we need four, rather than three, solutions, so that we can compute the slope at two different resolutions.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;100.0&lt;/span&gt;
&lt;span class="n"&gt;dt_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;v_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can now measure the convergence rate slope twice:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Measured convergence rate (base dt {}) is {:.7g}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Measured convergence rate (base dt 0.0005) is 1.011621.
Measured convergence rate (base dt 0.001) is 1.023266.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We then use Richardson extrapolation applied to the measured convergence rates (at finite resolution) to get the &amp;quot;&lt;em&gt;actual&lt;/em&gt;&amp;quot; convergence rate and its accuracy:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_exact&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;error_e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_exact&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;The convergence rate lies in the interval [{:.7g},{:.7g}]&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;s_exact&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s_exact&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
The convergence rate lies in the interval [0.9883297,1.011621]

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We see that $\sm{\dt} \simeq 1.023$ is &lt;em&gt;close enough&lt;/em&gt; when $\sm{\dt/2} \simeq 1.012$, as the interval is consistent with $s_e=1$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Finding-the-limits"&gt;Finding the limits&lt;a class="anchor-link" href="#Finding-the-limits"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Once again, we want to know what the limiting values are. In this case we&amp;#39;re interested in fixing $s_e$ and $\sm{\dt}$, and finding the value of $\sm{\dt/2}$ that is close enough.&lt;/p&gt;
&lt;p&gt;So the model we&amp;#39;ll use is that $s_m = s_e + c_1 \dt$, as above, so we need&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  2 \sm{\dt/2} - \sm{\dt} - | \sm{\dt/2} - \sm{\dt} | \le s_e \le 2 \sm{\dt/2} - \sm{\dt} + | \sm{\dt/2} - \sm{\dt} |.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;In the case where $\sm{\dt/2} &amp;lt; \sm{\dt}$  this gives&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  3 \sm{\dt/2} - 2\sm{\dt} \le s_e \le \sm{\dt/2} \quad \implies \quad \sm{\dt/2} \le \tfrac{1}{3} \left( 2 \sm{\dt} + s_e \right).
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;In the case where $\sm{\dt/2} &amp;gt; \sm{\dt}$  this gives&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \sm{\dt/2} \le s_e \le 3 \sm{\dt/2} - 2 \sm{\dt} \quad \implies \quad \sm{\dt/2} \ge \tfrac{1}{3} \left( 2 \sm{\dt} + s_e \right).
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;We can write this in terms of the &lt;em&gt;error&lt;/em&gt; in the slope as&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  | \sm{\dt/2} - s_e | \le \frac{2}{3} | \sm{\dt} - s_e |;
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;that is, the error must go down by at least a factor of $1/3$ when the step size is cut in half.&lt;/p&gt;
&lt;p&gt;So, if we fix $s_e=1$ (as for Euler&amp;#39;s method), we can see the &lt;em&gt;upper&lt;/em&gt; bound on $\sm{\dt/2}$ given $s_m = 1.023$ is:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;span class="n"&gt;s_mdthalf_max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Upper bound when s_e=1 and s_m (coarse resolution)=1.023: &amp;quot;&lt;/span&gt;
      &lt;span class="s"&gt;&amp;quot;{:.7f}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_mdthalf_max&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Upper bound when s_e=1 and s_m (coarse resolution)=1.023: 1.0155107.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In general, for Euler&amp;#39;s method, the bound varies linearly:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;bound&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fill_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;bound&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;facecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c"&gt;#pyplot.ylim(1.0, 2.5)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;r&amp;quot;$s_m^{(\Delta t)}$&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;r&amp;quot;$s_m^{(\Delta t / 2)}$&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
gg==
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Summary"&gt;Summary&lt;a class="anchor-link" href="#Summary"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If we want the algorithm to behave in the way expected of Euler&amp;#39;s method, then measuring a single convergence rate is useful but not sufficient. Instead we must measure the convergence rate twice, once with base timestep $\dt$ and once with base timestep $\dt/2$. The difference between the measured slope $\sm{\dt}$ and the expected slope $s_e=1$ must go down by at least $1/3$ when the timestep is reduced to $\dt/2$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can &lt;a href="http://IanHawke.github.io/blog/notebooks/02-Close-Enough-Slopes.ipynb"&gt;download this notebook&lt;/a&gt;.&lt;/p&gt;</summary><category term="Python"></category><category term="IPython notebook"></category><category term="Testing Scientific Code"></category></entry><entry><title>Close Enough Part 1</title><link href="http://IanHawke.github.io/blog/close-enough-part-1.html" rel="alternate"></link><updated>2015-04-15T09:10:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-04-15:blog/close-enough-part-1.html</id><summary type="html">&lt;!-- the next line is the key to include the notebook here: --&gt;

&lt;p&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;$$
\newcommand{\dt}{\Delta t}
\newcommand{\udt}[1]{u^{({#1})}(T)}
\newcommand{\Edt}[1]{E^{({#1})}}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is the first in a series of posts on testing scientific software. For this to make sense, you&amp;#39;ll need to have skimmed &lt;a href="http://ianhawke.github.io/blog/close-enough.html"&gt;the motivation and background&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We&amp;#39;re starting from Euler&amp;#39;s method, which is first order. That means that the difference between the exact solution $u(T)$ and the numerical approximation $\udt{\dt}$ should be proportional to $\dt$: that is, &lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  u(T) - \udt{\dt} = c_1 \dt + {\cal O}(\dt^2) \simeq c_1 \dt^{s_e}
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;with $s_e=1$. By performing some simulations, we can measure (to some accuracy) the slope $s_m$. The problem is that the measured slope $s_m$ will be &amp;quot;contaminated&amp;quot; by the higher order terms, proportional to $\dt^2$ and higher powers of $\dt$. For sufficiently small $\dt$ the measured value $s_m$ will be indistinguishable from the expected value $s_e=1$. However, we rarely get to use a sufficiently small $\dt$. So how close does $s_m$ need to be to $s_e$ to be close enough?&lt;/p&gt;
&lt;p&gt;One argument that can be justified: $0.585 \lesssim s_m \lesssim 1.585$ is close enough when $s_e = 1$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Error-bars-and-Richardson-extrapolation"&gt;Error bars and Richardson extrapolation&lt;a class="anchor-link" href="#Error-bars-and-Richardson-extrapolation"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The argument starts by assuming that what we care about is not the algorithm, but the solution $u(T)$. From the solution of &lt;em&gt;any&lt;/em&gt; numerical algorithm we cannot compute $u(T)$ exactly, but only estimate it with some error. Given a set of numerical calculations - $\udt{\dt}, \udt{2\dt}$ for example - and a model of how the algorithm behaves, then both the exact solution &lt;em&gt;and&lt;/em&gt; the error bars can be estimated. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Claim&lt;/strong&gt;: if two models estimate exact solutions that lie within each other&amp;#39;s error bars, they are indistinguishable. Hence, if the model corresponding to the &lt;em&gt;measured&lt;/em&gt; slope is consistent with that of the &lt;em&gt;expected&lt;/em&gt; slope, the algorithm implemented is close enough.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;To make this concrete, we need a model of the algorithm. The simplest models are&lt;/p&gt;
&lt;p&gt;$$
\begin{align}
  u(T) - \udt{\dt} &amp;amp; = c_e \dt^{s_e}, \\
  u(T) - \udt{\dt} &amp;amp; = c_m \dt^{s_m}.
\end{align}
$$&lt;/p&gt;
&lt;p&gt;Using &lt;a href="http://en.wikipedia.org/wiki/Richardson_extrapolation"&gt;Richardson extrapolation&lt;/a&gt; we can estimate both the solution $u(T)$ and also the error $\Edt{\dt} = u(T) - \udt{\dt}$. For Richardson extrapolation we perform two numerical calculations $\udt{\dt}$ and $\udt{2\dt}$ and combine them as&lt;/p&gt;
&lt;p&gt;$$
\begin{align}
  \udt{e} &amp;amp; = \frac{2^{s_e} \udt{\dt} - \udt{2\dt}}{2^{s_e} - 1}, &amp;amp; \Edt{e, \dt} &amp;amp; = \frac{\udt{\dt} - \udt{2\dt}}{2^{s_e} - 1}, \\
  \udt{m} &amp;amp; = \frac{2^{s_m} \udt{\dt} - \udt{2\dt}}{2^{s_m} - 1}, &amp;amp; \Edt{m, \dt} &amp;amp; = \frac{\udt{\dt} - \udt{2\dt}}{2^{s_m} - 1}.
\end{align}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The models are consistent if&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  \udt{e} \in \udt{m} \pm \Edt{m, \dt} \quad \text{and} \quad \udt{m} \in \udt{e} \pm \Edt{e, \dt}.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;That is, if both models predict the same exact solution, within their own error bounds, then we can&amp;#39;t tell the difference between them, and they&amp;#39;re close enough.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Checking-the-MOOC-solution"&gt;Checking the MOOC solution&lt;a class="anchor-link" href="#Checking-the-MOOC-solution"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can use this criteria to check the result from &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;the full phugoid model notebook&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;#39;s take the code from there directly.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;math&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ceil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.family&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;serif&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;font.size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="c"&gt;# model parameters:&lt;/span&gt;
&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;9.8&lt;/span&gt;      &lt;span class="c"&gt;# gravity in m s^{-2}&lt;/span&gt;
&lt;span class="n"&gt;v_t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;30.0&lt;/span&gt;   &lt;span class="c"&gt;# trim velocity in m s^{-1}   &lt;/span&gt;
&lt;span class="n"&gt;C_D&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;40.&lt;/span&gt;  &lt;span class="c"&gt;# drag coefficient --- or D/L if C_L=1&lt;/span&gt;
&lt;span class="n"&gt;C_L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;    &lt;span class="c"&gt;# for convenience, use C_L = 1&lt;/span&gt;

&lt;span class="c"&gt;### set initial conditions ###&lt;/span&gt;
&lt;span class="n"&gt;v0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_t&lt;/span&gt;     &lt;span class="c"&gt;# start at the trim velocity (or add a delta)&lt;/span&gt;
&lt;span class="n"&gt;theta0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="c"&gt;# initial angle of trajectory&lt;/span&gt;
&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;     &lt;span class="c"&gt;# horizotal position is arbitrary&lt;/span&gt;
&lt;span class="n"&gt;y0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1000.0&lt;/span&gt;  &lt;span class="c"&gt;# initial altitude&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the right-hand side of the phugoid system of equations.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the solution at time n.&lt;/span&gt;
&lt;span class="sd"&gt;        &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    dudt : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        array containing the RHS given u.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;C_D&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;C_L&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v_t&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns the solution at the next time-step using Euler&amp;#39;s method.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Parameters&lt;/span&gt;
&lt;span class="sd"&gt;    ----------&lt;/span&gt;
&lt;span class="sd"&gt;    u : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        solution at the previous time-step.&lt;/span&gt;
&lt;span class="sd"&gt;    f : function&lt;/span&gt;
&lt;span class="sd"&gt;        function to compute the right hand-side of the system of equation.&lt;/span&gt;
&lt;span class="sd"&gt;    dt : float&lt;/span&gt;
&lt;span class="sd"&gt;        time-increment.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Returns&lt;/span&gt;
&lt;span class="sd"&gt;    -------&lt;/span&gt;
&lt;span class="sd"&gt;    u_n_plus_1 : array of float&lt;/span&gt;
&lt;span class="sd"&gt;        approximate solution at the next time step.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now we&amp;#39;re going to compute the result at a specific time and do the convergence test. We&amp;#39;ll use an end time of &lt;code&gt;T=100&lt;/code&gt; as in the original notebook, and convergence test on &lt;code&gt;v&lt;/code&gt; as an example.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;100.0&lt;/span&gt;
&lt;span class="n"&gt;dt_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;v_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;euler_step&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We now have three calculated values of &lt;code&gt;v&lt;/code&gt; using parameter values &lt;code&gt;dt=0.001, 0.002, 0.004&lt;/code&gt;. That is:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dt_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value of v({}) = {:.7g} when dt={}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dt&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Value of v(100.0) = 29.86798 when dt=0.001.
Value of v(100.0) = 29.86667 when dt=0.002.
Value of v(100.0) = 29.864 when dt=0.004.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As in the original notebook, we can measure the order of convergence using&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  s_m = \log_2 \left| \frac{\udt{4\dt} - \udt{2\dt}}{\udt{2\dt} - \udt{\dt}} \right|.
\end{equation}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Measured convergence rate is {:.4g}.&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Measured convergence rate is 1.023.

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As in the original notebook, this is close to one, but not exactly one. So we now use the two most accurate data points with our two models, with &lt;em&gt;expected&lt;/em&gt; convergence rate $s_e = 1$ and &lt;em&gt;measured&lt;/em&gt; convergence rate $s_m \simeq 1.023$. We compute our exact solutions and error intervals.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;v_exact_e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;v_exact_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;error_e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_exact_e&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;error_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_exact_m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Then we check if they are consistent:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Does the expected solution {:.7g} lie within the interval &amp;quot;&lt;/span&gt;
      &lt;span class="s"&gt;&amp;quot;[{:.7g}, {:.7g}]&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;from the measured model? {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Does the measured solution {:.7g} lie within the interval &amp;quot;&lt;/span&gt;
      &lt;span class="s"&gt;&amp;quot;[{:.7g}, {:.7g}]&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;from the exact model? {}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
        &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Does the expected solution 29.8693 lie within the interval [29.86798, 29.87053]
from the measured model? True
Does the measured solution 29.86925 lie within the interval [29.86798, 29.87061]
from the exact model? True

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So the two models are indistinguishable: $s_m \simeq 1.023$ is &lt;em&gt;close enough&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Finding-the-limits"&gt;Finding the limits&lt;a class="anchor-link" href="#Finding-the-limits"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, how different can $s_m$ be from one and still be close enough? First, let&amp;#39;s do this experimentally, by plotting the intervals as we vary $s_m$:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;v_exact_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;interval_lower&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;interval_upper&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;s_m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;error_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;v_values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;interval_lower&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt;
    &lt;span class="n"&gt;interval_upper&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_m&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;g-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
            &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Exact model&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;r-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Measured model&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fill_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v_exact_e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;error_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;facecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                    &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;None&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Exact model interval&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fill_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_m_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interval_lower&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interval_upper&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;facecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                    &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;None&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Measured model interval&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;r&amp;quot;$s_m$&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
Obt37w76eYcFMxu0N8Bs7tzeb9u2mYiYeX8Ohq6NGzeac87MzB599FFzztmJJ57Ypd6xxx5rjz32
mJmZOeds1KhRXeps2rTJcnJybOrUqbZhw4ZA2XHHHWcpKSm2evXqLo/7q1/9yhobG83M7JNPPrHx
48fb2LFjraampkPbX/va12zy5Mm2ZcsWMzPbs2ePXXfddeacs8LCwkC9JUuWmHPObrzxxi79c87Z
9OnTu5TfcMMN5pyzo48+2hYsWGBNTU22a9cuGzNmjC1cuNDMzO69917z+Xx23XXX2Z49e6ylpcWe
eeYZS0hIsG984xsd2vvwww8tLi7Ojj32WNu6dauZmX366ac2bdo0S09P7/a168mCBQvMOWdHHXWU
Pf7442ZmtmXLFhs5cqQlJCTYlVdeGfi5bN682QoKCmzs2LHW3NzcoZ3nn3/eoqOj7aKLLrKqqioz
M1u2bJmNGjXKJkyYYBUVFYG6jY2NduKJJ1psbKw999xzZmZWXV1tV1xxhU2cONGcc7Z06dJu2589
e3ag/TfffNP8fr8deeSRVldX16F+QUFB0K9DML+jrXX65z20vxoKx1tQAeFvf+vzBRcZCvYpIHgL
hg/u7QBpHxBaWlrs0EMPNeecvfbaa4E6L7/8so0fPz7wfU8B4Rvf+Ib5fD777LPPOpSvWrXKnHN2
xhlnBMq2b9/e5Y3VzHujcc7ZfffdFyjbtWuXOefspz/9aZf6U6dOte3btwe+X7x48V4HhLlz55pz
zr773e92KF+0aJGtXr3atm7datHR0Xb00Ud3OXbOnDnmnLO///3vgbKTTjrJfD6frVy5skPd1157
rcfXrifz588355ydeeaZHcr/67/+q9vyX/7yl+acs3fffTdQVlNTY1lZWZaSkmK1tbUd6reFwssv
vzxQNm/ePHPO2bXXXtuhbnNzs40cObJLQKipqbHMzEwbMWKE1dfXdzjmj3/8oznn7Le//W2H8nAO
CEP7FAPAypVQVRXqXohIGHHOcd111wEd5yLcdNNN/OIXv+j12J07d/Liiy+Sn5/PxIkTO9w3fvx4
EhMTWbRoEc3NzQDk5OR0O+lxwoQJACxvN1cqLi6O5ORk5s+fz8MPP8yePXsC973//vvk5OTs5TPt
3owZM7p8P27cOJ544gkaGxs57bTTuhxz9NFHA19M4CwrK+Ott94iLy8v8FzaTJs2jYiIiH3q23HH
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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We see a few things. Firstly the lower limit is identical for both models for all $s_m$. This shouldn&amp;#39;t be surprising: one of the edges of the interval will always be $\udt{\dt}$, from the definitions of the error and the interval.&lt;/p&gt;
&lt;p&gt;Second, we see that for small enough $s_m$ the predicted solution for the measured model falls outside the interval for the exact model: this occurs when $s_m \simeq 0.6$. For large enough $s_m$, the predicted solution for the exact model falls outside the interval for the measured model: this occurs when $s_m \simeq 1.6$. &lt;/p&gt;
&lt;p&gt;This gives a very wide range of values for $s_m$ that are &amp;quot;close enough&amp;quot;. Also, it&amp;#39;s specific to this data. However, we can do a general calculation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="The-general-interval"&gt;The general interval&lt;a class="anchor-link" href="#The-general-interval"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We have a definition for our two models, defining two intervals and the solutions that should fall within them. We can do a symbolic calculation to check when this happens. First, we write out the inequalities that need to be satisfied:&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
\left| \frac{2^{s_e} y^{(h)} - y^{(2h)}}{2^{s_e} - 1} - \frac{2^{s_m} y^{(h)} - y^{(2h)}}{2^{s_m} - 1} \right| \le \left| \frac{y^{(2h)} - y^{(h)}}{2^{s_e} - 1} \right|
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
\left| \frac{2^{s_e} y^{(h)} - y^{(2h)}}{2^{s_e} - 1} - \frac{2^{s_m} y^{(h)} - y^{(2h)}}{2^{s_m} - 1} \right| \le \left| \frac{y^{(2h)} - y^{(h)}}{2^{s_m} - 1} \right| .
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;Noting as above that only two need solving (as one edge of the inequality will always agree), we can solve:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sympy&lt;/span&gt;
&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_printing&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;y^h, y^{2h}, s_e, s_m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Eq1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Eq&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Eq1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;


&lt;div class="output_latex output_subarea output_pyout"&gt;
$$\left [ \frac{\log{\left (2^{s_{e} + 1} - 1 \right )}}{\log{\left (2 \right )}}\right ]$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;Eq2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Eq&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y2h&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;yh&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Eq2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;


&lt;div class="output_latex output_subarea output_pyout"&gt;
$$\left [ \frac{\log{\left (\frac{2^{s_{e}}}{2} + \frac{1}{2} \right )}}{\log{\left (2 \right )}}\right ]$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, for Euler&amp;#39;s method where $s_e=1$ we find the interval must be:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Acceptable interval is [{:.6g}, {:.6g}].&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
                                                        &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;
Acceptable interval is [0.584963, 1.58496].

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This matches well with the results above, and is completely independent of the data, and indeed the method: the only thing that matters is the expected convergence rate $s_e=1$. As we vary the expected convergence rate, the acceptable &lt;em&gt;measured&lt;/em&gt; convergence rate also varies, and in fact the acceptable interval around $s_e$ gets larger:&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class="highlight-ipynb"&gt;&lt;pre class="ipynb"&gt;&lt;span class="n"&gt;s_e&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;upper_limit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lower_limit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fill_between&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lower_limit&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;upper_limit&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s_e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;facecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;r&amp;#39;$s_e$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;r&amp;quot;Acceptable $s_m-s_e$&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pyplot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
TkSuQmCC
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Summary"&gt;Summary&lt;a class="anchor-link" href="#Summary"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If all you care about is the answer that the algorithm gives you, then the measured convergence rate doesn&amp;#39;t matter very much. Use Richardson extrapolation to estimate the exact solution, given multiple numerical solutions, and check that the estimated error is in a range that you&amp;#39;re comfortable with.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="More-reading"&gt;More reading&lt;a class="anchor-link" href="#More-reading"&gt;&amp;#182;&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;See also &lt;a href="http://www.grc.nasa.gov/WWW/wind/valid/tutorial/spatconv.html"&gt;this page from NASA on grid convergence&lt;/a&gt;. Also &lt;a href="http://ocw.mit.edu/courses/mathematics/18-304-undergraduate-seminar-in-discrete-mathematics-spring-2006/projects/xtrpltn_liu_xpnd.pdf"&gt;this paper by Liu&lt;/a&gt;, which is rather mathematical, on Richardson extrapolation and its extensions.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can &lt;a href="http://IanHawke.github.io/blog/notebooks/01-Close-Enough-Errorbars.ipynb"&gt;download this notebook&lt;/a&gt;.&lt;/p&gt;</summary><category term="Python"></category><category term="IPython notebook"></category><category term="Testing Scientific Code"></category></entry><entry><title>Close Enough</title><link href="http://IanHawke.github.io/blog/close-enough.html" rel="alternate"></link><updated>2015-04-15T09:00:00+01:00</updated><author><name>Ian Hawke</name></author><id>tag:IanHawke.github.io,2015-04-15:blog/close-enough.html</id><summary type="html">&lt;!-- the next line is the key to include the notebook here: --&gt;

&lt;p&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Back in October, Greg Wilson &lt;a href="http://software-carpentry.org/blog/2014/10/why-we-dont-teach-testing.html"&gt;blogged about testing scientific software&lt;/a&gt;. He specifically points to &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;a lesson introducing the Euler method&lt;/a&gt; as part of the &lt;a href="http://openedx.seas.gwu.edu/courses/GW/MAE6286/2014_fall/about"&gt;Practical Numerical Methods with Python MOOC&lt;/a&gt;, and asks why a certain number (the measured convergence rate) is &lt;em&gt;close enough&lt;/em&gt; to the expected value.&lt;/p&gt;
&lt;p&gt;The big question of testing in scientific software, how this should be done, and how it is being done, has led to the &lt;a href="https://github.com/swcarpentry/close-enough-for-scientific-work"&gt;&lt;em&gt;Close Enough for Scientific Work&lt;/em&gt;&lt;/a&gt; project, as launched and explained by Greg Wilson in &lt;a href="http://software-carpentry.org/blog/2014/11/close-enough-for-scientific-work.html"&gt;this blog post&lt;/a&gt;. If you&amp;#39;re reading this, you should be following that project! As I&amp;#39;ve helped out on the MOOC, which is led by &lt;a href="http://lorenabarba.com/"&gt;Lorena Barba&lt;/a&gt;, I&amp;#39;ve been (over)thinking what sort of answer we could, or should, give. Well aware that we&amp;#39;re heading for the &lt;a href="https://www2.bc.edu/~radinr/Management_Humor/jokes.htm"&gt;academic version of the balloon joke&lt;/a&gt; (an answer that is correct, of little use, and took a long time to arrive), I&amp;#39;ve outlined some answers in the posts linked below.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Background"&gt;Background&lt;a class="anchor-link" href="#Background"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;$$
\newcommand{\dt}{\Delta t}
\newcommand{\udt}[1]{u^{({#1})}(T)}
$$&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We have a system of differential equations to solve: the solution will be $u(t)$. The numerical solution we get will depend on one parameter, the timestep $\dt$. The resulting numerical approximation, at the point $t=T$, will be $\udt{\dt}$: the exact solution is $u(T)$. &lt;/p&gt;
&lt;p&gt;The method used is Euler&amp;#39;s method, also &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_02_Phugoid_Oscillation.ipynb"&gt;introduced in an earlier lesson in the MOOC&lt;/a&gt;, and &lt;a href="https://www.youtube.com/watch?v=6i6qhqDCViA"&gt;explained in detail by Lorena in this screencast&lt;/a&gt;. The key result derived there is that Euler&amp;#39;s method is &lt;em&gt;first order&lt;/em&gt;, so that&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  u(T) - \udt{\dt} = c_1 \dt + c_2 \dt^2 + {\cal O}(\dt^3) \simeq c_1 \dt.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;For sufficiently small $\dt$ the error is proportional to $\dt$.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As we can&amp;#39;t (usually) know the exact solution $u(T)$ ahead of time, a standard check is &lt;em&gt;grid convergence&lt;/em&gt;: compute three solutions with different timesteps (eg, $\dt, 2\dt, 4\dt$) and compare them. The comparison to use is&lt;/p&gt;
&lt;p&gt;$$
\begin{equation}
  s_m = \log_2 \left( \frac{\udt{4\dt} - \udt{2\dt}}{\udt{2\dt} - \udt{\dt}} \right) \simeq 1.
\end{equation}
$$&lt;/p&gt;
&lt;p&gt;The symbol $s_m$ is used as it&amp;#39;s the &lt;em&gt;(measured) slope&lt;/em&gt; of the best fit line through the errors, as shown on the &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;original lesson&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/IanHawke/close-enough-balloons/master/images/slope1.png" alt="Image"&gt;&lt;/p&gt;
&lt;h4 id="figure-1-convergence-test-plot-taken-from-the-original-lesson-"&gt;Figure 1. Convergence test plot taken from the original lesson.&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The &lt;a href="http://nbviewer.ipython.org/github/numerical-mooc/numerical-mooc/blob/master/lessons/01_phugoid/01_03_PhugoidFullModel.ipynb"&gt;original lesson&lt;/a&gt; does precisely this comparison (using the phugoid model, with specific parameter values, and $\dt = 0.001$), finding a measured slope $s_m = 1.014$. Is this &lt;em&gt;close enough&lt;/em&gt; to 1?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="TL;DR:-Answer"&gt;TL;DR: Answer&lt;a class="anchor-link" href="#TL;DR:-Answer"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Answer&lt;strong&gt;s&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://ianhawke.github.io/blog/close-enough-part-1.html"&gt;&lt;em&gt;I don&amp;#39;t care about the algorithm: I just want the answer to be right&lt;/em&gt;&lt;/a&gt;: $0.585 \lesssim s_m \lesssim 1.585$ is close enough for Euler&amp;#39;s method.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ianhawke.github.io/blog/close-enough-part-2.html"&gt;&lt;em&gt;I don&amp;#39;t care about the answer: I just want the algorithm behaviour to be right&lt;/em&gt;&lt;/a&gt;: $s_m=1.014$ with $\dt=0.001$ is close enough if $1 \le s_m \le 1.0093$ with $\dt=0.0005$.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ianhawke.github.io/blog/close-enough-part-3.html"&gt;&lt;em&gt;I don&amp;#39;t care about the behaviour: I just want to know I&amp;#39;ve implemented Euler&amp;#39;s method&lt;/em&gt;&lt;/a&gt;: measure the local truncation error instead, and check &lt;em&gt;both&lt;/em&gt; the convergence rate &lt;em&gt;and&lt;/em&gt; the leading order constant. $s_m$ by itself is useless.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="And-yet-more"&gt;And yet more&lt;a class="anchor-link" href="#And-yet-more"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The accuracy of the convergence rate was just one small point in &lt;a href="http://software-carpentry.org/blog/2014/10/why-we-dont-teach-testing.html"&gt;Greg&amp;#39;s original post&lt;/a&gt;. The more substantial question was on testing a &amp;quot;real&amp;quot; code, such as &lt;a href="http://benchmarksgame.alioth.debian.org/u32/program.php?test=nbody&amp;amp;lang=python3&amp;amp;id=1"&gt;this n-body simulation code&lt;/a&gt;. To illustrate how far you can go with the approaches described above, &lt;a href="http://ianhawke.github.io/blog/close-enough-part-4.html"&gt;here&amp;#39;s my attempt at testing that code&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h6 id="Acknowledgements"&gt;Acknowledgements&lt;a class="anchor-link" href="#Acknowledgements"&gt;&amp;#182;&lt;/a&gt;&lt;/h6&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Aside from the obvious debts to Lorena Barba and Greg Wilson, both for starting this off and for later comments, I&amp;#39;ve also benefitted from comments from and discussions with Hans Fangohr and Ashwin Srinath.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can &lt;a href="http://IanHawke.github.io/blog/notebooks/00-Close-Enough-Post-Overall.ipynb"&gt;download this notebook&lt;/a&gt;.&lt;/p&gt;</summary><category term="Python"></category><category term="IPython notebook"></category><category term="Testing Scientific Code"></category></entry></feed>